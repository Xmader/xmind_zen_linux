<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: lib/gendocx.js</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":false,"cleverLinks":false,"default":{"outputSourceFiles":true}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html"></a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="gruntfile">
            <span class="title">
                <a href="gruntfile.html">gruntfile</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="gruntfile.default"><a href="gruntfile.html#.default">default</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="officegen#plugins">
            <span class="title">
                <a href="officegen_plugins.html">officegen#plugins</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="officegen#plugins.getDocTypeByName"><a href="officegen_plugins.html#.getDocTypeByName">getDocTypeByName</a></li>
            
                <li data-name="officegen#plugins.getPrototypeByName"><a href="officegen_plugins.html#.getPrototypeByName">getPrototypeByName</a></li>
            
                <li data-name="officegen#plugins.getVerboseMode"><a href="officegen_plugins.html#.getVerboseMode">getVerboseMode</a></li>
            
                <li data-name="officegen#plugins.registerDocType"><a href="officegen_plugins.html#.registerDocType">registerDocType</a></li>
            
                <li data-name="officegen#plugins.registerParserType"><a href="officegen_plugins.html#.registerParserType">registerParserType</a></li>
            
                <li data-name="officegen#plugins.registerPrototype"><a href="officegen_plugins.html#.registerPrototype">registerPrototype</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="officegen#private">
            <span class="title">
                <a href="officegen_private.html">officegen#private</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="officegen#private#plugs">
            <span class="title">
                <a href="officegen_private_plugs.html">officegen#private#plugs</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="officegen#private#plugs.type"><a href="officegen_private_plugs.html#.type">type</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="officegen#private#plugs.intAddAnyResourceToParse"><a href="officegen_private_plugs.html#.intAddAnyResourceToParse">intAddAnyResourceToParse</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makedocpluginapi">
            <span class="title">
                <a href="makedocpluginapi.html">makedocpluginapi</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makedocpluginapi#emitEvent"><a href="makedocpluginapi.html#emitEvent">emitEvent</a></li>
            
                <li data-name="makedocpluginapi#getDataStorage"><a href="makedocpluginapi.html#getDataStorage">getDataStorage</a></li>
            
                <li data-name="makedocpluginapi#getFeaturesStorage"><a href="makedocpluginapi.html#getFeaturesStorage">getFeaturesStorage</a></li>
            
                <li data-name="makedocpluginapi#getVerboseMode"><a href="makedocpluginapi.html#getVerboseMode">getVerboseMode</a></li>
            
                <li data-name="makedocpluginapi#logIfVerbose"><a href="makedocpluginapi.html#logIfVerbose">logIfVerbose</a></li>
            
                <li data-name="makedocpluginapi#registerCallback"><a href="makedocpluginapi.html#registerCallback">registerCallback</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makeDocx">
            <span class="title">
                <a href="makeDocx.html">makeDocx</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makeDocx~cbMakeDocxApp"><a href="makeDocx.html#~cbMakeDocxApp">cbMakeDocxApp</a></li>
            
                <li data-name="makeDocx~cbMakeDocxDocument"><a href="makeDocx.html#~cbMakeDocxDocument">cbMakeDocxDocument</a></li>
            
                <li data-name="makeDocx~cbMakeDocxFontsTable"><a href="makeDocx.html#~cbMakeDocxFontsTable">cbMakeDocxFontsTable</a></li>
            
                <li data-name="makeDocx~cbMakeDocxSettings"><a href="makeDocx.html#~cbMakeDocxSettings">cbMakeDocxSettings</a></li>
            
                <li data-name="makeDocx~cbMakeDocxStyles"><a href="makeDocx.html#~cbMakeDocxStyles">cbMakeDocxStyles</a></li>
            
                <li data-name="makeDocx~cbMakeDocxWeb"><a href="makeDocx.html#~cbMakeDocxWeb">cbMakeDocxWeb</a></li>
            
                <li data-name="makeDocx~cbPrepareDocxToGenerate"><a href="makeDocx.html#~cbPrepareDocxToGenerate">cbPrepareDocxToGenerate</a></li>
            
                <li data-name="makeDocx~setDefaultDocValues"><a href="makeDocx.html#~setDefaultDocValues">setDefaultDocValues</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makelayoutplugin">
            <span class="title">
                <a href="makelayoutplugin.html">makelayoutplugin</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makelayoutplugin#beforeGen"><a href="makelayoutplugin.html#beforeGen">beforeGen</a></li>
            
                <li data-name="makelayoutplugin#extendPptxApi"><a href="makelayoutplugin.html#extendPptxApi">extendPptxApi</a></li>
            
                <li data-name="makelayoutplugin#extendPptxSlideApi"><a href="makelayoutplugin.html#extendPptxSlideApi">extendPptxSlideApi</a></li>
            
                <li data-name="makelayoutplugin#setData"><a href="makelayoutplugin.html#setData">setData</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makemsdoc">
            <span class="title">
                <a href="makemsdoc.html">makemsdoc</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makemsdoc~cbMakeCore"><a href="makemsdoc.html#~cbMakeCore">cbMakeCore</a></li>
            
                <li data-name="makemsdoc~cbMakeMainFilesList"><a href="makemsdoc.html#~cbMakeMainFilesList">cbMakeMainFilesList</a></li>
            
                <li data-name="makemsdoc~cbMakeTheme"><a href="makemsdoc.html#~cbMakeTheme">cbMakeTheme</a></li>
            
                <li data-name="makemsdoc~cbOfficeClearAfterGenerate"><a href="makemsdoc.html#~cbOfficeClearAfterGenerate">cbOfficeClearAfterGenerate</a></li>
            
                <li data-name="makemsdoc~cbOfficeClearDocData"><a href="makemsdoc.html#~cbOfficeClearDocData">cbOfficeClearDocData</a></li>
            
                <li data-name="makemsdoc~clearSmartArrayFromType"><a href="makemsdoc.html#~clearSmartArrayFromType">clearSmartArrayFromType</a></li>
            
                <li data-name="makemsdoc~compactArray"><a href="makemsdoc.html#~compactArray">compactArray</a></li>
            
                <li data-name="makemsdoc~getCurDateTimeForOffice"><a href="makemsdoc.html#~getCurDateTimeForOffice">getCurDateTimeForOffice</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makeoodoc">
            <span class="title">
                <a href="makeoodoc.html">makeoodoc</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makeoodoc~makeOpenOfficeMimeType"><a href="makeoodoc.html#~makeOpenOfficeMimeType">makeOpenOfficeMimeType</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makePptx">
            <span class="title">
                <a href="makePptx.html">makePptx</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makePptx~cbGenerateEffects"><a href="makePptx.html#~cbGenerateEffects">cbGenerateEffects</a></li>
            
                <li data-name="makePptx~cbMakeCharts"><a href="makePptx.html#~cbMakeCharts">cbMakeCharts</a></li>
            
                <li data-name="makePptx~cbMakePptxApp"><a href="makePptx.html#~cbMakePptxApp">cbMakePptxApp</a></li>
            
                <li data-name="makePptx~cbMakePptxLayout"><a href="makePptx.html#~cbMakePptxLayout">cbMakePptxLayout</a></li>
            
                <li data-name="makePptx~cbMakePptxPresentation"><a href="makePptx.html#~cbMakePptxPresentation">cbMakePptxPresentation</a></li>
            
                <li data-name="makePptx~cbMakePptxPresProps"><a href="makePptx.html#~cbMakePptxPresProps">cbMakePptxPresProps</a></li>
            
                <li data-name="makePptx~cbMakePptxSlide"><a href="makePptx.html#~cbMakePptxSlide">cbMakePptxSlide</a></li>
            
                <li data-name="makePptx~cbMakePptxSlideMasters"><a href="makePptx.html#~cbMakePptxSlideMasters">cbMakePptxSlideMasters</a></li>
            
                <li data-name="makePptx~cbMakePptxStyles"><a href="makePptx.html#~cbMakePptxStyles">cbMakePptxStyles</a></li>
            
                <li data-name="makePptx~cbMakePptxViewProps"><a href="makePptx.html#~cbMakePptxViewProps">cbMakePptxViewProps</a></li>
            
                <li data-name="makePptx~cbPreparePptxToGenerate"><a href="makePptx.html#~cbPreparePptxToGenerate">cbPreparePptxToGenerate</a></li>
            
                <li data-name="makePptx~cMakePptxColorSelection"><a href="makePptx.html#~cMakePptxColorSelection">cMakePptxColorSelection</a></li>
            
                <li data-name="makePptx~cMakePptxOutTextCommand"><a href="makePptx.html#~cMakePptxOutTextCommand">cMakePptxOutTextCommand</a></li>
            
                <li data-name="makePptx~cMakePptxOutTextData"><a href="makePptx.html#~cMakePptxOutTextData">cMakePptxOutTextData</a></li>
            
                <li data-name="makePptx~createBodyProperties"><a href="makePptx.html#~createBodyProperties">createBodyProperties</a></li>
            
                <li data-name="makePptx~CreateFieldText"><a href="makePptx.html#~CreateFieldText">CreateFieldText</a></li>
            
                <li data-name="makePptx~getShapeInfo"><a href="makePptx.html#~getShapeInfo">getShapeInfo</a></li>
            
                <li data-name="makePptx~parseSmartNumber"><a href="makePptx.html#~parseSmartNumber">parseSmartNumber</a></li>
            
                <li data-name="makePptx~setDefaultDocValues"><a href="makePptx.html#~setDefaultDocValues">setDefaultDocValues</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makespknotesplugin">
            <span class="title">
                <a href="makespknotesplugin.html">makespknotesplugin</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makespknotesplugin#beforeGen"><a href="makespknotesplugin.html#beforeGen">beforeGen</a></li>
            
                <li data-name="makespknotesplugin#cbMakePptxNotesMasters"><a href="makespknotesplugin.html#cbMakePptxNotesMasters">cbMakePptxNotesMasters</a></li>
            
                <li data-name="makespknotesplugin#cbMakePptxSpkNote"><a href="makespknotesplugin.html#cbMakePptxSpkNote">cbMakePptxSpkNote</a></li>
            
                <li data-name="makespknotesplugin#cbMakeTheme2"><a href="makespknotesplugin.html#cbMakeTheme2">cbMakeTheme2</a></li>
            
                <li data-name="makespknotesplugin#extendPptxSlideApi"><a href="makespknotesplugin.html#extendPptxSlideApi">extendPptxSlideApi</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makewidescreenplugin">
            <span class="title">
                <a href="makewidescreenplugin.html">makewidescreenplugin</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makewidescreenplugin#extendPptxApi"><a href="makewidescreenplugin.html#extendPptxApi">extendPptxApi</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makeXlsx">
            <span class="title">
                <a href="makeXlsx.html">makeXlsx</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makeXlsx~cbCellToNumber"><a href="makeXlsx.html#~cbCellToNumber">cbCellToNumber</a></li>
            
                <li data-name="makeXlsx~cbMakeXlsApp"><a href="makeXlsx.html#~cbMakeXlsApp">cbMakeXlsApp</a></li>
            
                <li data-name="makeXlsx~cbMakeXlsSharedStrings"><a href="makeXlsx.html#~cbMakeXlsSharedStrings">cbMakeXlsSharedStrings</a></li>
            
                <li data-name="makeXlsx~cbMakeXlsSheet"><a href="makeXlsx.html#~cbMakeXlsSheet">cbMakeXlsSheet</a></li>
            
                <li data-name="makeXlsx~cbMakeXlsStyles"><a href="makeXlsx.html#~cbMakeXlsStyles">cbMakeXlsStyles</a></li>
            
                <li data-name="makeXlsx~cbMakeXlsWorkbook"><a href="makeXlsx.html#~cbMakeXlsWorkbook">cbMakeXlsWorkbook</a></li>
            
                <li data-name="makeXlsx~cbNumberToCell"><a href="makeXlsx.html#~cbNumberToCell">cbNumberToCell</a></li>
            
                <li data-name="makeXlsx~cbPrepareXlsxToGenerate"><a href="makeXlsx.html#~cbPrepareXlsxToGenerate">cbPrepareXlsxToGenerate</a></li>
            
                <li data-name="makeXlsx~setDefaultDocValues"><a href="makeXlsx.html#~setDefaultDocValues">setDefaultDocValues</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="officegen">
            <span class="title">
                <a href="officegen.html">officegen</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="officegen#addResourceToParse"><a href="officegen.html#addResourceToParse">addResourceToParse</a></li>
            
                <li data-name="officegen#generate"><a href="officegen.html#generate">generate</a></li>
            
                <li data-name="officegen#startNewDoc"><a href="officegen.html#startNewDoc">startNewDoc</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="lib_gendocx.js.html">Source: lib/gendocx.js</h1>
        


    
    <section>
        <article>
            <pre id="source-code" class="prettyprint source "><code>//
// officegen: All the code to generate DOCX files.
//
// Please refer to README.md for this module's documentations.
//
// NOTE:
// - Before changing this code please refer to the hacking the code section on README.md.
//
// Copyright (c) 2013 Ziv Barber;
//
// Permission is hereby granted, free of charge, to any person obtaining
// a copy of this software and associated documentation files (the
// 'Software'), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to
// permit persons to whom the Software is furnished to do so, subject to
// the following conditions:
//
// The above copyright notice and this permission notice shall be
// included in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,
// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
//

/**
 * Basicgen plugin to create docx files (Microsoft World).
 */

var baseobj = require("./basicgen.js");
var msdoc = require("./msofficegen.js");
var docxTable = require('./docxtable.js');
var xmlBuilder = require('xmlbuilder');

var path = require('path');

var fast_image_size = require('fast-image-size');

var docplugman = require('./docplug');

// Officegen docx plugins:
// BMK_DOCX_PLUG:

if ( !String.prototype.encodeHTML ) {
	String.prototype.encodeHTML = function () {
		return this.replace(/&amp;/g, '&amp;amp;')
			.replace(/&lt;/g, '&amp;lt;')
			.replace(/>/g, '&amp;gt;')
			.replace(/"/g, '&amp;quot;');
	};
}

/**
 * Extend officegen object with DOCX support.
 * &lt;br />&lt;br />
 *
 * This method extending the given officegen object to create DOCX document.
 *
 * @param[in] genobj The object to extend.
 * @param[in] new_type The type of object to create.
 * @param[in] options The object's options.
 * @param[in] gen_private Access to the internals of this object.
 * @param[in] type_info Additional information about this type.
 * @constructor
 * @name makeDocx
 */
function makeDocx ( genobj, new_type, options, gen_private, type_info ) {
	/**
	 * Prepare the default data.
	 * @param {object} docpluginman Access to the document plugins manager.
	 */
	function setDefaultDocValues ( docpluginman ) {
		var pptxData = docpluginman.getDataStorage ();

		// Please put any setting that API can override here:
	}

	/**
	 * Prepare everything to generate a docx zip.
	 */
	function cbPrepareDocxToGenerate () {
		// Tell all the features (plugins) that we are about to generate a new document zip:
		gen_private.features.type.docx.emitEvent ( 'beforeGen', genobj );

		// Allow some plugins to do more stuff after all the plugins added their data:
		gen_private.features.type.docx.emitEvent ( 'beforeGenFinal', genobj );
	}

	/**
	 * ???.
	 *
	 * @param[in] data Ignored by this callback function.
	 * @return Text string.
	 */
	function cbMakeDocxFontsTable ( data ) {
		return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '&lt;w:fonts xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">&lt;w:font w:name="Calibri">&lt;w:panose1 w:val="020F0502020204030204"/>&lt;w:charset w:val="00"/>&lt;w:family w:val="swiss"/>&lt;w:pitch w:val="variable"/>&lt;w:sig w:usb0="A00002EF" w:usb1="4000207B" w:usb2="00000000" w:usb3="00000000" w:csb0="0000009F" w:csb1="00000000"/>&lt;/w:font>&lt;w:font w:name="Arial">&lt;w:panose1 w:val="020B0604020202020204"/>&lt;w:charset w:val="00"/>&lt;w:family w:val="swiss"/>&lt;w:pitch w:val="variable"/>&lt;w:sig w:usb0="20002A87" w:usb1="80000000" w:usb2="00000008" w:usb3="00000000" w:csb0="000001FF" w:csb1="00000000"/>&lt;/w:font>&lt;w:font w:name="Times New Roman">&lt;w:panose1 w:val="02020603050405020304"/>&lt;w:charset w:val="00"/>&lt;w:family w:val="roman"/>&lt;w:pitch w:val="variable"/>&lt;w:sig w:usb0="20002A87" w:usb1="80000000" w:usb2="00000008" w:usb3="00000000" w:csb0="000001FF" w:csb1="00000000"/>&lt;/w:font>&lt;w:font w:name="Cambria">&lt;w:panose1 w:val="02040503050406030204"/>&lt;w:charset w:val="00"/>&lt;w:family w:val="roman"/>&lt;w:pitch w:val="variable"/>&lt;w:sig w:usb0="A00002EF" w:usb1="4000004B" w:usb2="00000000" w:usb3="00000000" w:csb0="0000009F" w:csb1="00000000"/>&lt;/w:font>&lt;/w:fonts>';
	}

	/**
	 * ???.
	 *
	 * @param[in] data Ignored by this callback function.
	 * @return Text string.
	 */
	function cbMakeDocxSettings ( data ) {
		return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '&lt;w:settings xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:sl="http://schemas.openxmlformats.org/schemaLibrary/2006/main">&lt;w:zoom w:percent="120"/>&lt;w:defaultTabStop w:val="720"/>&lt;w:characterSpacingControl w:val="doNotCompress"/>&lt;w:compat/>&lt;w:rsids>&lt;w:rsidRoot w:val="00A94AF2"/>&lt;w:rsid w:val="00A02F19"/>&lt;w:rsid w:val="00A94AF2"/>&lt;/w:rsids>&lt;m:mathPr>&lt;m:mathFont m:val="Cambria Math"/>&lt;m:brkBin m:val="before"/>&lt;m:brkBinSub m:val="--"/>&lt;m:smallFrac m:val="off"/>&lt;m:dispDef/>&lt;m:lMargin m:val="0"/>&lt;m:rMargin m:val="0"/>&lt;m:defJc m:val="centerGroup"/>&lt;m:wrapIndent m:val="1440"/>&lt;m:intLim m:val="subSup"/>&lt;m:naryLim m:val="undOvr"/>&lt;/m:mathPr>&lt;w:themeFontLang w:val="en-US" w:bidi="en-US"/>&lt;w:clrSchemeMapping w:bg1="light1" w:t1="dark1" w:bg2="light2" w:t2="dark2" w:accent1="accent1" w:accent2="accent2" w:accent3="accent3" w:accent4="accent4" w:accent5="accent5" w:accent6="accent6" w:hyperlink="hyperlink" w:followedHyperlink="followedHyperlink"/>&lt;w:shapeDefaults>&lt;o:shapedefaults v:ext="edit" spidmax="2050"/>&lt;o:shapelayout v:ext="edit">&lt;o:idmap v:ext="edit" data="1"/>&lt;/o:shapelayout>&lt;/w:shapeDefaults>&lt;w:decimalSymbol w:val="."/>&lt;w:listSeparator w:val=","/>&lt;/w:settings>';
	}


	// NJC - added to support bullets
	function cbMakeDocxNumbers ( data ) {
		console.log('make numbers');
		return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '&lt;w:numbering xmlns:wpc="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas" xmlns:mo="http://schemas.microsoft.com/office/mac/office/2008/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mv="urn:schemas-microsoft-com:mac:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:wp14="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:w14="http://schemas.microsoft.com/office/word/2010/wordml" xmlns:w15="http://schemas.microsoft.com/office/word/2012/wordml" xmlns:wpg="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup" xmlns:wpi="http://schemas.microsoft.com/office/word/2010/wordprocessingInk" xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml" xmlns:wps="http://schemas.microsoft.com/office/word/2010/wordprocessingShape" mc:Ignorable="w14 w15 wp14">&lt;w:abstractNum w:abstractNumId="0">&lt;w:nsid w:val="709F643A"/>&lt;w:multiLevelType w:val="hybridMultilevel"/>&lt;w:tmpl w:val="B8B464D0"/>&lt;w:lvl w:ilvl="0" w:tplc="04090001">&lt;w:start w:val="1"/>&lt;w:numFmt w:val="bullet"/>&lt;w:lvlText w:val=""/>&lt;w:lvlJc w:val="left"/>&lt;w:pPr>&lt;w:ind w:left="720" w:hanging="360"/>&lt;/w:pPr>&lt;w:rPr>&lt;w:rFonts w:ascii="Symbol" w:hAnsi="Symbol" w:hint="default"/>&lt;/w:rPr>&lt;/w:lvl>&lt;w:lvl w:ilvl="1" w:tplc="04090003" w:tentative="1">&lt;w:start w:val="1"/>&lt;w:numFmt w:val="bullet"/>&lt;w:lvlText w:val="o"/>&lt;w:lvlJc w:val="left"/>&lt;w:pPr>&lt;w:ind w:left="1440" w:hanging="360"/>&lt;/w:pPr>&lt;w:rPr>&lt;w:rFonts w:ascii="Courier New" w:hAnsi="Courier New" w:cs="Courier New" w:hint="default"/>&lt;/w:rPr>&lt;/w:lvl>&lt;w:lvl w:ilvl="2" w:tplc="04090005" w:tentative="1">&lt;w:start w:val="1"/>&lt;w:numFmt w:val="bullet"/>&lt;w:lvlText w:val=""/>&lt;w:lvlJc w:val="left"/>&lt;w:pPr>&lt;w:ind w:left="2160" w:hanging="360"/>&lt;/w:pPr>&lt;w:rPr>&lt;w:rFonts w:ascii="Wingdings" w:hAnsi="Wingdings" w:hint="default"/>&lt;/w:rPr>&lt;/w:lvl>&lt;w:lvl w:ilvl="3" w:tplc="04090001" w:tentative="1">&lt;w:start w:val="1"/>&lt;w:numFmt w:val="bullet"/>&lt;w:lvlText w:val=""/>&lt;w:lvlJc w:val="left"/>&lt;w:pPr>&lt;w:ind w:left="2880" w:hanging="360"/>&lt;/w:pPr>&lt;w:rPr>&lt;w:rFonts w:ascii="Symbol" w:hAnsi="Symbol" w:hint="default"/>&lt;/w:rPr>&lt;/w:lvl>&lt;w:lvl w:ilvl="4" w:tplc="04090003" w:tentative="1">&lt;w:start w:val="1"/>&lt;w:numFmt w:val="bullet"/>&lt;w:lvlText w:val="o"/>&lt;w:lvlJc w:val="left"/>&lt;w:pPr>&lt;w:ind w:left="3600" w:hanging="360"/>&lt;/w:pPr>&lt;w:rPr>&lt;w:rFonts w:ascii="Courier New" w:hAnsi="Courier New" w:cs="Courier New" w:hint="default"/>&lt;/w:rPr>&lt;/w:lvl>&lt;w:lvl w:ilvl="5" w:tplc="04090005" w:tentative="1">&lt;w:start w:val="1"/>&lt;w:numFmt w:val="bullet"/>&lt;w:lvlText w:val=""/>&lt;w:lvlJc w:val="left"/>&lt;w:pPr>&lt;w:ind w:left="4320" w:hanging="360"/>&lt;/w:pPr>&lt;w:rPr>&lt;w:rFonts w:ascii="Wingdings" w:hAnsi="Wingdings" w:hint="default"/>&lt;/w:rPr>&lt;/w:lvl>&lt;w:lvl w:ilvl="6" w:tplc="04090001" w:tentative="1">&lt;w:start w:val="1"/>&lt;w:numFmt w:val="bullet"/>&lt;w:lvlText w:val=""/>&lt;w:lvlJc w:val="left"/>&lt;w:pPr>&lt;w:ind w:left="5040" w:hanging="360"/>&lt;/w:pPr>&lt;w:rPr>&lt;w:rFonts w:ascii="Symbol" w:hAnsi="Symbol" w:hint="default"/>&lt;/w:rPr>&lt;/w:lvl>&lt;w:lvl w:ilvl="7" w:tplc="04090003" w:tentative="1">&lt;w:start w:val="1"/>&lt;w:numFmt w:val="bullet"/>&lt;w:lvlText w:val="o"/>&lt;w:lvlJc w:val="left"/>&lt;w:pPr>&lt;w:ind w:left="5760" w:hanging="360"/>&lt;/w:pPr>&lt;w:rPr>&lt;w:rFonts w:ascii="Courier New" w:hAnsi="Courier New" w:cs="Courier New" w:hint="default"/>&lt;/w:rPr>&lt;/w:lvl>&lt;w:lvl w:ilvl="8" w:tplc="04090005" w:tentative="1">&lt;w:start w:val="1"/>&lt;w:numFmt w:val="bullet"/>&lt;w:lvlText w:val=""/>&lt;w:lvlJc w:val="left"/>&lt;w:pPr>&lt;w:ind w:left="6480" w:hanging="360"/>&lt;/w:pPr>&lt;w:rPr>&lt;w:rFonts w:ascii="Wingdings" w:hAnsi="Wingdings" w:hint="default"/>&lt;/w:rPr>&lt;/w:lvl>&lt;/w:abstractNum>&lt;w:num w:numId="1">&lt;w:abstractNumId w:val="0"/>&lt;/w:num>&lt;/w:numbering>';
	}

	/**
	 * ???.
	 *
	 * @param[in] data Ignored by this callback function.
	 * @return Text string.
	 */
	function cbMakeDocxWeb ( data ) {
		return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '&lt;w:webSettings xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">&lt;w:optimizeForBrowser/>&lt;/w:webSettings>';
	}

	/**
	 * ???.
	 *
	 * @param[in] data Ignored by this callback function.
	 * @return Text string.
	 */
	function cbMakeDocxStyles ( data ) {
		return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '&lt;w:styles xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">&lt;w:docDefaults>&lt;w:rPrDefault>&lt;w:rPr>&lt;w:rFonts w:asciiTheme="minorHAnsi" w:eastAsiaTheme="minorHAnsi" w:hAnsiTheme="minorHAnsi" w:cstheme="minorBidi"/>&lt;w:sz w:val="22"/>&lt;w:szCs w:val="22"/>&lt;w:lang w:val="en-US" w:eastAsia="en-US" w:bidi="en-US"/>&lt;/w:rPr>&lt;/w:rPrDefault>&lt;w:pPrDefault>&lt;w:pPr>&lt;w:spacing w:after="200" w:line="276" w:lineRule="auto"/>&lt;/w:pPr>&lt;/w:pPrDefault>&lt;/w:docDefaults>&lt;w:latentStyles w:defLockedState="0" w:defUIPriority="99" w:defSemiHidden="1" w:defUnhideWhenUsed="1" w:defQFormat="0" w:count="267">&lt;w:lsdException w:name="Normal" w:semiHidden="0" w:uiPriority="0" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="heading 1" w:semiHidden="0" w:uiPriority="9" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="heading 2" w:uiPriority="9" w:qFormat="1"/>&lt;w:lsdException w:name="heading 3" w:uiPriority="9" w:qFormat="1"/>&lt;w:lsdException w:name="heading 4" w:uiPriority="9" w:qFormat="1"/>&lt;w:lsdException w:name="heading 5" w:uiPriority="9" w:qFormat="1"/>&lt;w:lsdException w:name="heading 6" w:uiPriority="9" w:qFormat="1"/>&lt;w:lsdException w:name="heading 7" w:uiPriority="9" w:qFormat="1"/>&lt;w:lsdException w:name="heading 8" w:uiPriority="9" w:qFormat="1"/>&lt;w:lsdException w:name="heading 9" w:uiPriority="9" w:qFormat="1"/>&lt;w:lsdException w:name="toc 1" w:uiPriority="39"/>&lt;w:lsdException w:name="toc 2" w:uiPriority="39"/>&lt;w:lsdException w:name="toc 3" w:uiPriority="39"/>&lt;w:lsdException w:name="toc 4" w:uiPriority="39"/>&lt;w:lsdException w:name="toc 5" w:uiPriority="39"/>&lt;w:lsdException w:name="toc 6" w:uiPriority="39"/>&lt;w:lsdException w:name="toc 7" w:uiPriority="39"/>&lt;w:lsdException w:name="toc 8" w:uiPriority="39"/>&lt;w:lsdException w:name="toc 9" w:uiPriority="39"/>&lt;w:lsdException w:name="caption" w:uiPriority="35" w:qFormat="1"/>&lt;w:lsdException w:name="Title" w:semiHidden="0" w:uiPriority="10" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Default Paragraph Font" w:uiPriority="1"/>&lt;w:lsdException w:name="Subtitle" w:semiHidden="0" w:uiPriority="11" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Strong" w:semiHidden="0" w:uiPriority="22" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Emphasis" w:semiHidden="0" w:uiPriority="20" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Table Grid" w:semiHidden="0" w:uiPriority="59" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Placeholder Text" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="No Spacing" w:semiHidden="0" w:uiPriority="1" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Light Shading" w:semiHidden="0" w:uiPriority="60" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light List" w:semiHidden="0" w:uiPriority="61" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Grid" w:semiHidden="0" w:uiPriority="62" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 1" w:semiHidden="0" w:uiPriority="63" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 2" w:semiHidden="0" w:uiPriority="64" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 1" w:semiHidden="0" w:uiPriority="65" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 2" w:semiHidden="0" w:uiPriority="66" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 1" w:semiHidden="0" w:uiPriority="67" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 2" w:semiHidden="0" w:uiPriority="68" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 3" w:semiHidden="0" w:uiPriority="69" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Dark List" w:semiHidden="0" w:uiPriority="70" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Shading" w:semiHidden="0" w:uiPriority="71" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful List" w:semiHidden="0" w:uiPriority="72" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Grid" w:semiHidden="0" w:uiPriority="73" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Shading Accent 1" w:semiHidden="0" w:uiPriority="60" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light List Accent 1" w:semiHidden="0" w:uiPriority="61" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Grid Accent 1" w:semiHidden="0" w:uiPriority="62" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 1 Accent 1" w:semiHidden="0" w:uiPriority="63" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 2 Accent 1" w:semiHidden="0" w:uiPriority="64" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 1 Accent 1" w:semiHidden="0" w:uiPriority="65" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Revision" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="List Paragraph" w:semiHidden="0" w:uiPriority="34" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Quote" w:semiHidden="0" w:uiPriority="29" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Intense Quote" w:semiHidden="0" w:uiPriority="30" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Medium List 2 Accent 1" w:semiHidden="0" w:uiPriority="66" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 1 Accent 1" w:semiHidden="0" w:uiPriority="67" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 2 Accent 1" w:semiHidden="0" w:uiPriority="68" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 3 Accent 1" w:semiHidden="0" w:uiPriority="69" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Dark List Accent 1" w:semiHidden="0" w:uiPriority="70" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Shading Accent 1" w:semiHidden="0" w:uiPriority="71" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful List Accent 1" w:semiHidden="0" w:uiPriority="72" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Grid Accent 1" w:semiHidden="0" w:uiPriority="73" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Shading Accent 2" w:semiHidden="0" w:uiPriority="60" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light List Accent 2" w:semiHidden="0" w:uiPriority="61" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Grid Accent 2" w:semiHidden="0" w:uiPriority="62" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 1 Accent 2" w:semiHidden="0" w:uiPriority="63" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 2 Accent 2" w:semiHidden="0" w:uiPriority="64" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 1 Accent 2" w:semiHidden="0" w:uiPriority="65" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 2 Accent 2" w:semiHidden="0" w:uiPriority="66" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 1 Accent 2" w:semiHidden="0" w:uiPriority="67" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 2 Accent 2" w:semiHidden="0" w:uiPriority="68" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 3 Accent 2" w:semiHidden="0" w:uiPriority="69" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Dark List Accent 2" w:semiHidden="0" w:uiPriority="70" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Shading Accent 2" w:semiHidden="0" w:uiPriority="71" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful List Accent 2" w:semiHidden="0" w:uiPriority="72" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Grid Accent 2" w:semiHidden="0" w:uiPriority="73" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Shading Accent 3" w:semiHidden="0" w:uiPriority="60" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light List Accent 3" w:semiHidden="0" w:uiPriority="61" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Grid Accent 3" w:semiHidden="0" w:uiPriority="62" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 1 Accent 3" w:semiHidden="0" w:uiPriority="63" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 2 Accent 3" w:semiHidden="0" w:uiPriority="64" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 1 Accent 3" w:semiHidden="0" w:uiPriority="65" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 2 Accent 3" w:semiHidden="0" w:uiPriority="66" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 1 Accent 3" w:semiHidden="0" w:uiPriority="67" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 2 Accent 3" w:semiHidden="0" w:uiPriority="68" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 3 Accent 3" w:semiHidden="0" w:uiPriority="69" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Dark List Accent 3" w:semiHidden="0" w:uiPriority="70" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Shading Accent 3" w:semiHidden="0" w:uiPriority="71" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful List Accent 3" w:semiHidden="0" w:uiPriority="72" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Grid Accent 3" w:semiHidden="0" w:uiPriority="73" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Shading Accent 4" w:semiHidden="0" w:uiPriority="60" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light List Accent 4" w:semiHidden="0" w:uiPriority="61" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Grid Accent 4" w:semiHidden="0" w:uiPriority="62" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 1 Accent 4" w:semiHidden="0" w:uiPriority="63" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 2 Accent 4" w:semiHidden="0" w:uiPriority="64" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 1 Accent 4" w:semiHidden="0" w:uiPriority="65" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 2 Accent 4" w:semiHidden="0" w:uiPriority="66" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 1 Accent 4" w:semiHidden="0" w:uiPriority="67" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 2 Accent 4" w:semiHidden="0" w:uiPriority="68" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 3 Accent 4" w:semiHidden="0" w:uiPriority="69" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Dark List Accent 4" w:semiHidden="0" w:uiPriority="70" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Shading Accent 4" w:semiHidden="0" w:uiPriority="71" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful List Accent 4" w:semiHidden="0" w:uiPriority="72" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Grid Accent 4" w:semiHidden="0" w:uiPriority="73" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Shading Accent 5" w:semiHidden="0" w:uiPriority="60" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light List Accent 5" w:semiHidden="0" w:uiPriority="61" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Grid Accent 5" w:semiHidden="0" w:uiPriority="62" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 1 Accent 5" w:semiHidden="0" w:uiPriority="63" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 2 Accent 5" w:semiHidden="0" w:uiPriority="64" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 1 Accent 5" w:semiHidden="0" w:uiPriority="65" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 2 Accent 5" w:semiHidden="0" w:uiPriority="66" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 1 Accent 5" w:semiHidden="0" w:uiPriority="67" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 2 Accent 5" w:semiHidden="0" w:uiPriority="68" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 3 Accent 5" w:semiHidden="0" w:uiPriority="69" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Dark List Accent 5" w:semiHidden="0" w:uiPriority="70" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Shading Accent 5" w:semiHidden="0" w:uiPriority="71" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful List Accent 5" w:semiHidden="0" w:uiPriority="72" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Grid Accent 5" w:semiHidden="0" w:uiPriority="73" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Shading Accent 6" w:semiHidden="0" w:uiPriority="60" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light List Accent 6" w:semiHidden="0" w:uiPriority="61" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Light Grid Accent 6" w:semiHidden="0" w:uiPriority="62" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 1 Accent 6" w:semiHidden="0" w:uiPriority="63" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Shading 2 Accent 6" w:semiHidden="0" w:uiPriority="64" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 1 Accent 6" w:semiHidden="0" w:uiPriority="65" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium List 2 Accent 6" w:semiHidden="0" w:uiPriority="66" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 1 Accent 6" w:semiHidden="0" w:uiPriority="67" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 2 Accent 6" w:semiHidden="0" w:uiPriority="68" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Medium Grid 3 Accent 6" w:semiHidden="0" w:uiPriority="69" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Dark List Accent 6" w:semiHidden="0" w:uiPriority="70" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Shading Accent 6" w:semiHidden="0" w:uiPriority="71" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful List Accent 6" w:semiHidden="0" w:uiPriority="72" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Colorful Grid Accent 6" w:semiHidden="0" w:uiPriority="73" w:unhideWhenUsed="0"/>&lt;w:lsdException w:name="Subtle Emphasis" w:semiHidden="0" w:uiPriority="19" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Intense Emphasis" w:semiHidden="0" w:uiPriority="21" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Subtle Reference" w:semiHidden="0" w:uiPriority="31" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Intense Reference" w:semiHidden="0" w:uiPriority="32" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Book Title" w:semiHidden="0" w:uiPriority="33" w:unhideWhenUsed="0" w:qFormat="1"/>&lt;w:lsdException w:name="Bibliography" w:uiPriority="37"/>&lt;w:lsdException w:name="TOC Heading" w:uiPriority="39" w:qFormat="1"/>&lt;/w:latentStyles>&lt;w:style w:type="paragraph" w:default="1" w:styleId="Normal">&lt;w:name w:val="Normal"/>&lt;w:qFormat/>&lt;w:rsid w:val="00A02F19"/>&lt;/w:style>&lt;w:style w:type="character" w:default="1" w:styleId="DefaultParagraphFont">&lt;w:name w:val="Default Paragraph Font"/>&lt;w:uiPriority w:val="1"/>&lt;w:semiHidden/>&lt;w:unhideWhenUsed/>&lt;/w:style>&lt;w:style w:type="table" w:default="1" w:styleId="TableNormal">&lt;w:name w:val="Normal Table"/>&lt;w:uiPriority w:val="99"/>&lt;w:semiHidden/>&lt;w:unhideWhenUsed/>&lt;w:qFormat/>&lt;w:tblPr>&lt;w:tblInd w:w="0" w:type="dxa"/>&lt;w:tblCellMar>&lt;w:top w:w="0" w:type="dxa"/>&lt;w:left w:w="108" w:type="dxa"/>&lt;w:bottom w:w="0" w:type="dxa"/>&lt;w:right w:w="108" w:type="dxa"/>&lt;/w:tblCellMar>&lt;/w:tblPr>&lt;/w:style>&lt;w:style w:type="numbering" w:default="1" w:styleId="NoList">&lt;w:name w:val="No List"/>&lt;w:uiPriority w:val="99"/>&lt;w:semiHidden/>&lt;w:unhideWhenUsed/>&lt;/w:style>&lt;/w:styles>';
	}

	/**
	 * ???.
	 *
	 * @param[in] data Ignored by this callback function.
	 * @return Text string.
	 */
	function cbMakeDocxApp ( data ) {
		var userName = genobj.options.author || genobj.options.creator || 'officegen';
		var outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '&lt;Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes">&lt;Template>Normal.dotm&lt;/Template>&lt;TotalTime>1&lt;/TotalTime>&lt;Pages>1&lt;/Pages>&lt;Words>0&lt;/Words>&lt;Characters>0&lt;/Characters>&lt;Application>Microsoft Office Word&lt;/Application>&lt;DocSecurity>0&lt;/DocSecurity>&lt;Lines>1&lt;/Lines>&lt;Paragraphs>1&lt;/Paragraphs>&lt;ScaleCrop>false&lt;/ScaleCrop>&lt;Company>' + userName + '&lt;/Company>&lt;LinksUpToDate>false&lt;/LinksUpToDate>&lt;CharactersWithSpaces>0&lt;/CharactersWithSpaces>&lt;SharedDoc>false&lt;/SharedDoc>&lt;HyperlinksChanged>false&lt;/HyperlinksChanged>&lt;AppVersion>12.0000&lt;/AppVersion>&lt;/Properties>';
		return outString;
	}

	/**
	 * Create the document's itself resource.
	 *
	 * @param[in] data Ignored by this callback function.
	 * @return Text string.
	 */
	function cbMakeDocxDocument ( data ) {
		var outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '&lt;w:document xmlns:ve="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml">&lt;w:body>';
		var objs_list = data.data;

		// Work on all the stored paragraphs inside this document:
		for ( var i = 0, total_size = objs_list.length; i &lt; total_size; i++ ) {

			if (objs_list[i] &amp;&amp; objs_list[i].type === 'table') {
				var table_obj = docxTable.getTable(objs_list[i].data, objs_list[i].options);
          		var table_xml = xmlBuilder.create(table_obj,{version: '1.0', encoding: 'UTF-8', standalone: true}).toString({ pretty: true, indent: '  ', newline: '\n' });
	          	outString += table_xml;
	          	continue;
			}

			outString += '&lt;w:p w:rsidR="00A77427" w:rsidRDefault="007F1D13">';
			var pPrData = '';

			if ( objs_list[i].options ) {
				if ( objs_list[i].options.align ) {
					switch ( objs_list[i].options.align ) {
						case 'center':
							pPrData += '&lt;w:jc w:val="center"/>';
							break;

						case 'right':
							pPrData += '&lt;w:jc w:val="right"/>';
							break;

						case 'justify':
							pPrData += '&lt;w:jc w:val="both"/>';
							break;
					} // End of switch.
				} // Endif.

				if ( objs_list[i].options.list_type ) {
					pPrData += '&lt;w:pStyle w:val="ListParagraph"/>&lt;w:numPr>&lt;w:ilvl w:val="0"/>&lt;w:numId w:val="' + objs_list[i].options.list_type + '"/>&lt;/w:numPr>';
				} // Endif.

				if ( objs_list[i].options.backline ) {
					pPrData += '&lt;w:pPr>&lt;w:shd w:val="solid" w:color="' + objs_list[i].options.backline + '" w:fill="auto"/>&lt;/w:pPr>';
				} // Endif.
			} // Endif.

			if ( pPrData ) {
				outString += '&lt;w:pPr>' + pPrData + '&lt;/w:pPr>';
			} // Endif.

			// Work on all the objects in the document:
			for ( var j = 0, total_size_j = objs_list[i].data.length; j &lt; total_size_j; j++ ) {
				if ( objs_list[i].data[j] ) {
					var rExtra = '';
					var tExtra = '';
					var rPrData = '';
					var colorCode;
					var valType;
					var sizeVal;

					if ( objs_list[i].data[j].options ) {

						if ( objs_list[i].data[j].options.color ) {
							rPrData += '&lt;w:color w:val="' + objs_list[i].data[j].options.color + '"/>';
						} // Endif.

						if ( objs_list[i].data[j].options.back ) {
							colorCode = objs_list[i].data[j].options.shdColor || 'auto';
							valType = objs_list[i].data[j].options.shdType || 'clear';

							rPrData += '&lt;w:shd w:val="' + valType + '" w:color="' + colorCode + '" w:fill="' + objs_list[i].data[j].options.back + '"/>';
						} // Endif.

						if ( objs_list[i].data[j].options.highlight ) {
							valType = 'yellow';

							if ( typeof objs_list[i].data[j].options.highlight === 'string' ) {
								valType = objs_list[i].data[j].options.highlight;
							} // Endif.

							rPrData += '&lt;w:highlight w:val="' + valType + '"/>';
						} // Endif.

						if ( objs_list[i].data[j].options.bold ) {
							rPrData += '&lt;w:b/>&lt;w:bCs/>';
						} // Endif.

						if ( objs_list[i].data[j].options.italic ) {
							rPrData += '&lt;w:i/>&lt;w:iCs/>';
						} // Endif.

						if ( objs_list[i].data[j].options.underline ) {
							valType = 'single';

							if ( typeof objs_list[i].data[j].options.underline === 'string' ) {
								valType = objs_list[i].data[j].options.underline;
							} // Endif.

							rPrData += '&lt;w:u w:val="' + valType + '"/>';
						} // Endif.

						if ( objs_list[i].data[j].options.font_face ) {
							rPrData += '&lt;w:rFonts w:ascii="' + objs_list[i].data[j].options.font_face + '" w:eastAsia="' + objs_list[i].data[j].options.font_face + '" w:hAnsi="' + objs_list[i].data[j].options.font_face + '" w:cs="' + objs_list[i].data[j].options.font_face + '"/>';
						} // Endif.

						if ( objs_list[i].data[j].options.font_size ) {
							var fontSizeInHalfPoints = 2 * objs_list[i].data[j].options.font_size;
							rPrData += '&lt;w:sz w:val="' + fontSizeInHalfPoints + '"/>&lt;w:szCs w:val="' + fontSizeInHalfPoints + '"/>';
						} // Endif.

						if ( objs_list[i].data[j].options.border ) {
							colorCode = 'auto';
							valType = 'single';
							sizeVal = 4;

							if ( typeof objs_list[i].data[j].options.borderColor === 'string' ) {
								colorCode = objs_list[i].data[j].options.borderColor;
							} // Endif.

							if ( typeof objs_list[i].data[j].options.border === 'string' ) {
								valType = objs_list[i].data[j].options.border;
							} // Endif.

							if ( typeof objs_list[i].data[j].options.borderSize === 'number' &amp;&amp; objs_list[i].data[j].options.borderSize &amp;&amp; objs_list[i].data[j].options.borderSize === objs_list[i].data[j].options.borderSize ) {
								sizeVal = objs_list[i].data[j].options.borderSize;
							} // Endif.

							rPrData += '&lt;w:bdr w:val="' + valType + '" w:sz="' + sizeVal + '" w:space="0" w:color="' + colorCode + '"/>';
						} // Endif.
					} // Endif.

					if ( objs_list[i].data[j].text ) {
						if ( (objs_list[i].data[j].text[0] == ' ') || (objs_list[i].data[j].text[objs_list[i].data[j].text.length - 1] == ' ') ) {
							tExtra += ' xml:space="preserve"';
						} // Endif.

						if (objs_list[i].data[j].link_rel_id) {
							outString += '&lt;w:hyperlink r:id="rId' + objs_list[i].data[j].link_rel_id + '">';
						}

						outString += '&lt;w:r' + rExtra + '>';

						if ( rPrData ) {
							outString += '&lt;w:rPr>' + rPrData + '&lt;/w:rPr>';
						} // Endif.

						outString += '&lt;w:t' + tExtra + '>' + objs_list[i].data[j].text.encodeHTML () + '&lt;/w:t>&lt;/w:r>';

						if (objs_list[i].data[j].link_rel_id) {
							outString += '&lt;/w:hyperlink>';
						}

					} else if ( objs_list[i].data[j].page_break ) {
						outString += '&lt;w:r>&lt;w:br w:type="page"/>&lt;/w:r>';

					} else if ( objs_list[i].data[j].line_break ) {
						outString += '&lt;w:r>&lt;w:br/>&lt;/w:r>';
					} else if ( objs_list[i].data[j].horizontal_line ) {
						outString += '&lt;w:r>&lt;w:pict>&lt;v:rect style="width:0;height:.75pt" o:hralign="center" o:hrstd="t" o:hr="t" fillcolor="#e0e0e0" stroked="f"/>&lt;/w:pict>&lt;/w:r>';
					} else if ( objs_list[i].data[j].image ) {
						outString += '&lt;w:r' + rExtra + '>';

						rPrData += '&lt;w:noProof/>';

						if ( rPrData ) {
							outString += '&lt;w:rPr>' + rPrData + '&lt;/w:rPr>';
						} // Endif.

						//914400L / 96DPI
						var pixelToEmu = 9525;

						outString += '&lt;w:drawing>';
						outString += '&lt;wp:inline distT="0" distB="0" distL="0" distR="0">';
						outString += '&lt;wp:extent cx="' + (objs_list[i].data[j].options.cx * pixelToEmu) + '" cy="' + (objs_list[i].data[j].options.cy * pixelToEmu) + '"/>';
						outString += '&lt;wp:effectExtent l="19050" t="0" r="9525" b="0"/>';

						outString += '&lt;wp:docPr id="' + (objs_list[i].data[j].image_id + 1) + '" name="Picture ' + objs_list[i].data[j].image_id + '" descr="Picture ' + objs_list[i].data[j].image_id + '">';
						if(objs_list[i].data[j].link_rel_id){
							outString += '&lt;a:hlinkClick xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" r:id="rId'+objs_list[i].data[j].link_rel_id+'"/>';
						}
						outString += '&lt;/wp:docPr>';

						outString += '&lt;wp:cNvGraphicFramePr>';
						outString += '&lt;a:graphicFrameLocks xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" noChangeAspect="1"/>';
						outString += '&lt;/wp:cNvGraphicFramePr>';
						outString += '&lt;a:graphic xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">';
						outString += '&lt;a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture">';
						outString += '&lt;pic:pic xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture">';
						outString += '&lt;pic:nvPicPr>';
						outString += '&lt;pic:cNvPr id="0" name="Picture ' + objs_list[i].data[j].image_id + '"/>';
						outString += '&lt;pic:cNvPicPr/>';
						outString += '&lt;/pic:nvPicPr>';
						outString += '&lt;pic:blipFill>';
						outString += '&lt;a:blip r:embed="rId' + objs_list[i].data[j].rel_id + '" cstate="print"/>';
						outString += '&lt;a:stretch>';
						outString += '&lt;a:fillRect/>';
						outString += '&lt;/a:stretch>';
						outString += '&lt;/pic:blipFill>';
						outString += '&lt;pic:spPr>';
						outString += '&lt;a:xfrm>';
						outString += '&lt;a:off x="0" y="0"/>';
						outString += '&lt;a:ext cx="' + (objs_list[i].data[j].options.cx * pixelToEmu) + '" cy="' + (objs_list[i].data[j].options.cy * pixelToEmu) + '"/>';
						outString += '&lt;/a:xfrm>';
						outString += '&lt;a:prstGeom prst="rect">';
						outString += '&lt;a:avLst/>';
						outString += '&lt;/a:prstGeom>';
						outString += '&lt;/pic:spPr>';
						outString += '&lt;/pic:pic>';
						outString += '&lt;/a:graphicData>';
						outString += '&lt;/a:graphic>';
						outString += '&lt;/wp:inline>';
						outString += '&lt;/w:drawing>';

						outString += '&lt;/w:r>';
					} // Endif.
				} // Endif.
			} // Endif.

			outString += '&lt;/w:p>';
		} // End of for loop.

		outString += '&lt;w:p w:rsidR="00A02F19" w:rsidRDefault="00A02F19"/>';

		// Landscape orientation support:
		if ( options.orientation &amp;&amp; options.orientation === 'landscape' ){
			outString +=
				'&lt;w:sectPr w:rsidR="00A02F19" w:rsidSect="00897086">' +
				'&lt;w:pgSz w:w="15840" w:h="12240" w:orient="landscape"/>' +
				'&lt;w:pgMar w:top="1800" w:right="1440" w:bottom="1800" w:left="1440" w:header="720" w:footer="720" w:gutter="0"/>' +
				'&lt;w:cols w:space="720"/>' +
				'&lt;w:docGrid w:linePitch="360"/>' +
				'&lt;/w:sectPr>';
		} else {
			outString +=
				'&lt;w:sectPr w:rsidR="00A02F19" w:rsidSect="00A02F19">' +
				'&lt;w:pgSz w:w="12240" w:h="15840"/>' +
				'&lt;w:pgMar w:top="1440" w:right="1800" w:bottom="1440" w:left="1800" w:header="720" w:footer="720" w:gutter="0"/>' +
				'&lt;w:cols w:space="720"/>' +
				'&lt;w:docGrid w:linePitch="360"/>' +
				'&lt;/w:sectPr>';
		} // Endif.

		outString += '&lt;/w:body>&lt;/w:document>';

		return outString;
	}

	// Prepare genobj for MS-Office:
	msdoc.makemsdoc ( genobj, new_type, options, gen_private, type_info );
	gen_private.plugs.type.msoffice.makeOfficeGenerator ( 'word', 'document', {} );

	genobj.on ( 'clearData', function () {
		genobj.data.length = 0;
	});

	genobj.on ( 'beforeGen', cbPrepareDocxToGenerate );

	// Add the document's properties:
	gen_private.plugs.type.msoffice.addInfoType ( 'dc:title', '', 'title', 'setDocTitle' );
	gen_private.plugs.type.msoffice.addInfoType ( 'dc:subject', '', 'subject', 'setDocSubject' );
	gen_private.plugs.type.msoffice.addInfoType ( 'cp:keywords', '', 'keywords', 'setDocKeywords' );
	gen_private.plugs.type.msoffice.addInfoType ( 'dc:description', '', 'description', 'setDescription' );
	gen_private.plugs.type.msoffice.addInfoType ( 'cp:category', '', 'category', 'setDocCategory' );
	gen_private.plugs.type.msoffice.addInfoType ( 'cp:contentStatus', '', 'status', 'setDocStatus' );

	// Create the plugins manager:
	var plugsmanObj = new docplugman ( genobj, gen_private, 'docx', setDefaultDocValues );

	// We'll register now any officegen internal plugin that we want to always use for Word based documents:
	// BMK_DOCX_PLUG:

	// Dynamic loading of additional plugins requested by the user:
	if ( options.extraPlugs &amp;&amp; typeof options.extraPlugs === 'object' &amp;&amp; options.extraPlugs.forEach ) {
		options.extraPlugs.forEach ( function ( value ) {
			var newPlug;

			if ( value ) {
				if ( typeof value === 'function' ) {
					// You already loaded the plugin:
					newPlug = value;

				} else if ( typeof value === 'string' ) {
					// We need to load the plugin:
					newPlug = require ( './' + value );
				} // Endif.
			} // Endif.

			plugsmanObj.plugsList.push ( new newPlug ( plugsmanObj ) );
		});
	} // Endif.

	gen_private.type.msoffice.files_list.push (
		{
			name: '/word/settings.xml',
			type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml',
			clear: 'type'
		},
		{
			name: '/word/fontTable.xml',
			type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml',
			clear: 'type'
		},
		{
			name: '/word/webSettings.xml',
			type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml',
			clear: 'type'
		},
		{
			name: '/word/styles.xml',
			type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml',
			clear: 'type'
		},
		{
			name: '/word/document.xml',
			type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml',
			clear: 'type'
		},
		{   // NJC - 20161231 - added to support bullets
			name: '/word/numbering.xml',
			type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml',
			clear: 'type'
		}
	);

	gen_private.type.msoffice.rels_app.push (
		{
			type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles',
			target: 'styles.xml',
			clear: 'type'
		},
		{
			type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings',
			target: 'settings.xml',
			clear: 'type'
		},
		{
			type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings',
			target: 'webSettings.xml',
			clear: 'type'
		},
		{
			type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable',
			target: 'fontTable.xml',
			clear: 'type'
		},
		{
			type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',
			target: 'theme/theme1.xml',
			clear: 'type'
		},
		{   // NJC - 20161231 - added to support bullets
			type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering',
			target: 'numbering.xml',
			clear: 'type'
		}
	);

	genobj.data = []; // All the data will be placed here.

	gen_private.plugs.intAddAnyResourceToParse ( 'docProps\\app.xml', 'buffer', null, cbMakeDocxApp, true );
	gen_private.plugs.intAddAnyResourceToParse ( 'word\\fontTable.xml', 'buffer', null, cbMakeDocxFontsTable, true );
	gen_private.plugs.intAddAnyResourceToParse ( 'word\\settings.xml', 'buffer', null, cbMakeDocxSettings, true );
	gen_private.plugs.intAddAnyResourceToParse ( 'word\\webSettings.xml', 'buffer', null, cbMakeDocxWeb, true );
	gen_private.plugs.intAddAnyResourceToParse ( 'word\\styles.xml', 'buffer', null, cbMakeDocxStyles, true );
	gen_private.plugs.intAddAnyResourceToParse ( 'word\\document.xml', 'buffer', genobj, cbMakeDocxDocument, true );
	gen_private.plugs.intAddAnyResourceToParse ( 'word\\numbering.xml', 'buffer', null, cbMakeDocxNumbers, true ); // added to support bullets

	gen_private.plugs.intAddAnyResourceToParse ( 'word\\_rels\\document.xml.rels', 'buffer', gen_private.type.msoffice.rels_app, gen_private.plugs.type.msoffice.cbMakeRels, true );

	// ----- API for Word documents: -----

	/**
	 * Create a new paragraph.
	 *
	 * @param[in] options Default options for all the objects inside this paragraph.
	 */
	genobj.createP = function ( options ) {
		var newP = {};

		newP.data = [];
		newP.options = options || {};

		/**
		 * Insert text inside this paragraph.
		 *
		 * @param {string} text_msg The text message itself.
		 * @param {object} opt ???.
		 * @param {object} flag_data ???.
		 */
		newP.addText = function ( text_msg, opt, flag_data ) {
			var objNum = newP.data.length
			newP.data[objNum] = { text: text_msg, options: opt || {}, ext_data: flag_data };

			if ((opt || {}).link) {
				var link_rel_id = gen_private.type.msoffice.rels_app.length + 1;

				gen_private.type.msoffice.rels_app.push({
					type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink',
					target: opt.link,
					targetMode: 'External'
				})

				newP.data[objNum].link_rel_id = link_rel_id;
			}
		};

		/**
		 * Insert a line break inside this paragraph.
		 */
		newP.addLineBreak = function () {
			newP.data[newP.data.length] = { 'line_break': true };
		};

		/**
		 * Insert a horizontal line inside this paragraph.
		 */
		newP.addHorizontalLine = function () {
      		newP.data[newP.data.length] = { 'horizontal_line': true };
		};

		/**
		 * Insert an image into the current paragraph.
		 *
		 * @param {object} image_path The image file to add.
		 * @param {object} opt Additional options (cx, cy).
		 * @param {object} image_format_type ???.
		 */
		newP.addImage = function ( image_path, opt, image_format_type ) {
			var image_type = (typeof image_format_type == 'string') ? image_format_type : 'png';
			var defWidth = 320;
			var defHeight = 200;

			if ( typeof image_path == 'string' ) {
				var ret_data = fast_image_size ( image_path );
				if ( ret_data.type == 'unknown' ) {
					var image_ext = path.extname ( image_path );

					switch ( image_ext ) {
						case '.bmp':
							image_type = 'bmp';
							break;

						case '.gif':
							image_type = 'gif';
							break;

						case '.jpg':
						case '.jpeg':
							image_type = 'jpeg';
							break;

						case '.emf':
							image_type = 'emf';
							break;

						case '.tiff':
							image_type = 'tiff';
							break;
					} // End of switch.

				} else {
					if ( ret_data.width ) {
						defWidth = ret_data.width;
					} // Endif.

					if ( ret_data.height ) {
						defHeight = ret_data.height;
					} // Endif.

					image_type = ret_data.type;
					if ( image_type == 'jpg' ) {
						image_type = 'jpeg';
					} // Endif.
				} // Endif.
			} // Endif.

			var objNum = newP.data.length;
			newP.data[objNum] = { image: image_path, options: opt || {} };

			if ( !newP.data[objNum].options.cx &amp;&amp; defWidth ) {
				newP.data[objNum].options.cx = defWidth;
			} // Endif.

			if ( !newP.data[objNum].options.cy &amp;&amp; defHeight ) {
				newP.data[objNum].options.cy = defHeight;
			} // Endif.

			var image_id = gen_private.type.msoffice.src_files_list.indexOf ( image_path );
			var image_rel_id = -1;

			if ( image_id >= 0 ) {
				for ( var j = 0, total_size_j = gen_private.type.msoffice.rels_app.length; j &lt; total_size_j; j++ ) {
					if ( gen_private.type.msoffice.rels_app[j].target == ('media/image' + (image_id + 1) + '.' + image_type) ) {
						image_rel_id = j + 1;
					} // Endif.
				} // Endif.

			} else
			{
				image_id = gen_private.type.msoffice.src_files_list.length;
				gen_private.type.msoffice.src_files_list[image_id] = image_path;
				gen_private.plugs.intAddAnyResourceToParse ( 'word\\media\\image' + (image_id + 1) + '.' + image_type, (typeof image_path == 'string') ? 'file' : 'stream', image_path, null, false );
			} // Endif.

			if ( image_rel_id == -1 ) {
				image_rel_id = gen_private.type.msoffice.rels_app.length + 1;

				gen_private.type.msoffice.rels_app.push (
					{
						type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image',
						target: 'media/image' + (image_id + 1) + '.' + image_type,
						clear: 'data'
					}
				);
			} // Endif.

			if ((opt || {}).link) {

				var link_rel_id = gen_private.type.msoffice.rels_app.length + 1;

				gen_private.type.msoffice.rels_app.push({
					type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink',
					target: opt.link,
					targetMode: 'External'
				});

				newP.data[objNum].link_rel_id = link_rel_id;

			} // Endif.

			newP.data[objNum].image_id = image_id;
			newP.data[objNum].rel_id = image_rel_id;
		};

		genobj.data[genobj.data.length] = newP;

		return newP;
	};

	/**
	 * ???.
	 *
	 * @param {object} options ???.
	 */
	genobj.createListOfDots = function ( options ) {
		var newP = genobj.createP ( options );

		newP.options.list_type = '1';

		return newP;
	};

	/**
	 * Create a list of numbers based paragraph.
	 *
	 * @param {object} options ???.
	 */
	genobj.createListOfNumbers = function ( options ) {
		var newP = genobj.createP ( options );

		newP.options.list_type = '2';

		return newP;
	};

	/**
	 * Add a page break.
	 * &lt;br />&lt;br />
	 *
	 * This method add a page break to the current Word document.
	 */
	genobj.putPageBreak = function () {
		var newP = {};

		newP.data = [ { 'page_break': true } ];

		genobj.data[genobj.data.length] = newP;
		return newP;
	};

	/**
	 * Add a page break.
	 * &lt;br />&lt;br />
	 *
	 * This method add a page break to the current Word document.
	 */
	genobj.addPageBreak = function () {
		var newP = {};

		newP.data = [ { 'page_break': true } ];

		genobj.data[genobj.data.length] = newP;
		return newP;
	};

	/**
	 * Create a table.
	 * &lt;br />&lt;br />
	 *
	 * This method add a table to the current word document.
	 *
	 * @param {object} data ???.
	 * @param {object} options ???.
	 */
	genobj.createTable = function ( data, options ) {
		var newP = genobj.createP ( options );
		newP.data = data;
		newP.type = 'table';
		return newP;
	};

	/**
	 * Create Json.
	 * &lt;br />&lt;br />
	 *
	 * @param {object} data ???.
	 * @param {object} newP ???.
	 */
	genobj.createJson = function ( data, newP ) {
		newP = newP || genobj.createP(data.lopt || {});
		switch(data.type) {
			case "text":
				newP.addText(data.val, data.opt);
				break;
			case "linebreak":
				newP.addLineBreak();
				break;
			case "horizontalline":
				newP.addHorizontalLine();
				break;
			case "image":
				// Improved by peizhuang in Aug 2016 (added data.opt):
				// data.imagetype been added by Ziv Barber in Aug 2016.
				newP.addImage(data.path, data.opt || {}, data.imagetype );
				break;
			case "pagebreak":
				newP = genobj.putPageBreak();
				break;
			case "table":
				newP = genobj.createTable(data.val, data.opt);
				break;
			case "numlist":
				newP = genobj.createListOfDots();
				break;
			case "dotlist":
				newP = genobj.createListOfDots();
				break;
		}

		return newP;
	};

	/**
	 * Create a document by json data.
	 * &lt;br />&lt;br />
	 *
	 * @param {array} dataArray ???.
	 */
	genobj.createByJson = function ( dataArray ) {
		var newP = {};
		dataArray = [].concat(dataArray || []);
		dataArray.forEach(function(data) {
			if(Array.isArray(data)) {
				newP = genobj.createP(data.shift() || {});
				data.forEach( function(d) {
					newP = genobj.createJson(d, newP);
				});
			} else {
				newP = genobj.createJson(data);
			}
		});
		return newP;
	};

	// Tell all the features (plugins) to add extra API:
	gen_private.features.type.docx.emitEvent ( 'makeDocApi', genobj );

	return this;
}

baseobj.plugins.registerDocType ( 'docx', makeDocx, {}, baseobj.docType.TEXT, "Microsoft Word Document" );
</code></pre>
        </article>
    </section>






        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.1</a> on Sun Feb 05 2017 05:03:39 GMT+0100 (W. Europe Standard Time)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/jaguar.js"></script>
</body>
</html>
