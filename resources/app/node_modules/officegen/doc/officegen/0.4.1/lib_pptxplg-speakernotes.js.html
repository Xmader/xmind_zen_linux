<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: lib/pptxplg-speakernotes.js</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":false,"cleverLinks":false,"default":{"outputSourceFiles":true}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html"></a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="gruntfile">
            <span class="title">
                <a href="gruntfile.html">gruntfile</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="gruntfile.default"><a href="gruntfile.html#.default">default</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="officegen#plugins">
            <span class="title">
                <a href="officegen_plugins.html">officegen#plugins</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="officegen#plugins.getDocTypeByName"><a href="officegen_plugins.html#.getDocTypeByName">getDocTypeByName</a></li>
            
                <li data-name="officegen#plugins.getPrototypeByName"><a href="officegen_plugins.html#.getPrototypeByName">getPrototypeByName</a></li>
            
                <li data-name="officegen#plugins.getVerboseMode"><a href="officegen_plugins.html#.getVerboseMode">getVerboseMode</a></li>
            
                <li data-name="officegen#plugins.registerDocType"><a href="officegen_plugins.html#.registerDocType">registerDocType</a></li>
            
                <li data-name="officegen#plugins.registerParserType"><a href="officegen_plugins.html#.registerParserType">registerParserType</a></li>
            
                <li data-name="officegen#plugins.registerPrototype"><a href="officegen_plugins.html#.registerPrototype">registerPrototype</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="officegen#private">
            <span class="title">
                <a href="officegen_private.html">officegen#private</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="officegen#private#plugs">
            <span class="title">
                <a href="officegen_private_plugs.html">officegen#private#plugs</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="officegen#private#plugs.type"><a href="officegen_private_plugs.html#.type">type</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="officegen#private#plugs.intAddAnyResourceToParse"><a href="officegen_private_plugs.html#.intAddAnyResourceToParse">intAddAnyResourceToParse</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makedocpluginapi">
            <span class="title">
                <a href="makedocpluginapi.html">makedocpluginapi</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makedocpluginapi#emitEvent"><a href="makedocpluginapi.html#emitEvent">emitEvent</a></li>
            
                <li data-name="makedocpluginapi#getDataStorage"><a href="makedocpluginapi.html#getDataStorage">getDataStorage</a></li>
            
                <li data-name="makedocpluginapi#getFeaturesStorage"><a href="makedocpluginapi.html#getFeaturesStorage">getFeaturesStorage</a></li>
            
                <li data-name="makedocpluginapi#getVerboseMode"><a href="makedocpluginapi.html#getVerboseMode">getVerboseMode</a></li>
            
                <li data-name="makedocpluginapi#logIfVerbose"><a href="makedocpluginapi.html#logIfVerbose">logIfVerbose</a></li>
            
                <li data-name="makedocpluginapi#registerCallback"><a href="makedocpluginapi.html#registerCallback">registerCallback</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makeDocx">
            <span class="title">
                <a href="makeDocx.html">makeDocx</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makeDocx~cbMakeDocxApp"><a href="makeDocx.html#~cbMakeDocxApp">cbMakeDocxApp</a></li>
            
                <li data-name="makeDocx~cbMakeDocxDocument"><a href="makeDocx.html#~cbMakeDocxDocument">cbMakeDocxDocument</a></li>
            
                <li data-name="makeDocx~cbMakeDocxFontsTable"><a href="makeDocx.html#~cbMakeDocxFontsTable">cbMakeDocxFontsTable</a></li>
            
                <li data-name="makeDocx~cbMakeDocxSettings"><a href="makeDocx.html#~cbMakeDocxSettings">cbMakeDocxSettings</a></li>
            
                <li data-name="makeDocx~cbMakeDocxStyles"><a href="makeDocx.html#~cbMakeDocxStyles">cbMakeDocxStyles</a></li>
            
                <li data-name="makeDocx~cbMakeDocxWeb"><a href="makeDocx.html#~cbMakeDocxWeb">cbMakeDocxWeb</a></li>
            
                <li data-name="makeDocx~cbPrepareDocxToGenerate"><a href="makeDocx.html#~cbPrepareDocxToGenerate">cbPrepareDocxToGenerate</a></li>
            
                <li data-name="makeDocx~setDefaultDocValues"><a href="makeDocx.html#~setDefaultDocValues">setDefaultDocValues</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makelayoutplugin">
            <span class="title">
                <a href="makelayoutplugin.html">makelayoutplugin</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makelayoutplugin#beforeGen"><a href="makelayoutplugin.html#beforeGen">beforeGen</a></li>
            
                <li data-name="makelayoutplugin#extendPptxApi"><a href="makelayoutplugin.html#extendPptxApi">extendPptxApi</a></li>
            
                <li data-name="makelayoutplugin#extendPptxSlideApi"><a href="makelayoutplugin.html#extendPptxSlideApi">extendPptxSlideApi</a></li>
            
                <li data-name="makelayoutplugin#setData"><a href="makelayoutplugin.html#setData">setData</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makemsdoc">
            <span class="title">
                <a href="makemsdoc.html">makemsdoc</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makemsdoc~cbMakeCore"><a href="makemsdoc.html#~cbMakeCore">cbMakeCore</a></li>
            
                <li data-name="makemsdoc~cbMakeMainFilesList"><a href="makemsdoc.html#~cbMakeMainFilesList">cbMakeMainFilesList</a></li>
            
                <li data-name="makemsdoc~cbMakeTheme"><a href="makemsdoc.html#~cbMakeTheme">cbMakeTheme</a></li>
            
                <li data-name="makemsdoc~cbOfficeClearAfterGenerate"><a href="makemsdoc.html#~cbOfficeClearAfterGenerate">cbOfficeClearAfterGenerate</a></li>
            
                <li data-name="makemsdoc~cbOfficeClearDocData"><a href="makemsdoc.html#~cbOfficeClearDocData">cbOfficeClearDocData</a></li>
            
                <li data-name="makemsdoc~clearSmartArrayFromType"><a href="makemsdoc.html#~clearSmartArrayFromType">clearSmartArrayFromType</a></li>
            
                <li data-name="makemsdoc~compactArray"><a href="makemsdoc.html#~compactArray">compactArray</a></li>
            
                <li data-name="makemsdoc~getCurDateTimeForOffice"><a href="makemsdoc.html#~getCurDateTimeForOffice">getCurDateTimeForOffice</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makeoodoc">
            <span class="title">
                <a href="makeoodoc.html">makeoodoc</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makeoodoc~makeOpenOfficeMimeType"><a href="makeoodoc.html#~makeOpenOfficeMimeType">makeOpenOfficeMimeType</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makePptx">
            <span class="title">
                <a href="makePptx.html">makePptx</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makePptx~cbGenerateEffects"><a href="makePptx.html#~cbGenerateEffects">cbGenerateEffects</a></li>
            
                <li data-name="makePptx~cbMakeCharts"><a href="makePptx.html#~cbMakeCharts">cbMakeCharts</a></li>
            
                <li data-name="makePptx~cbMakePptxApp"><a href="makePptx.html#~cbMakePptxApp">cbMakePptxApp</a></li>
            
                <li data-name="makePptx~cbMakePptxLayout"><a href="makePptx.html#~cbMakePptxLayout">cbMakePptxLayout</a></li>
            
                <li data-name="makePptx~cbMakePptxPresentation"><a href="makePptx.html#~cbMakePptxPresentation">cbMakePptxPresentation</a></li>
            
                <li data-name="makePptx~cbMakePptxPresProps"><a href="makePptx.html#~cbMakePptxPresProps">cbMakePptxPresProps</a></li>
            
                <li data-name="makePptx~cbMakePptxSlide"><a href="makePptx.html#~cbMakePptxSlide">cbMakePptxSlide</a></li>
            
                <li data-name="makePptx~cbMakePptxSlideMasters"><a href="makePptx.html#~cbMakePptxSlideMasters">cbMakePptxSlideMasters</a></li>
            
                <li data-name="makePptx~cbMakePptxStyles"><a href="makePptx.html#~cbMakePptxStyles">cbMakePptxStyles</a></li>
            
                <li data-name="makePptx~cbMakePptxViewProps"><a href="makePptx.html#~cbMakePptxViewProps">cbMakePptxViewProps</a></li>
            
                <li data-name="makePptx~cbPreparePptxToGenerate"><a href="makePptx.html#~cbPreparePptxToGenerate">cbPreparePptxToGenerate</a></li>
            
                <li data-name="makePptx~cMakePptxColorSelection"><a href="makePptx.html#~cMakePptxColorSelection">cMakePptxColorSelection</a></li>
            
                <li data-name="makePptx~cMakePptxOutTextCommand"><a href="makePptx.html#~cMakePptxOutTextCommand">cMakePptxOutTextCommand</a></li>
            
                <li data-name="makePptx~cMakePptxOutTextData"><a href="makePptx.html#~cMakePptxOutTextData">cMakePptxOutTextData</a></li>
            
                <li data-name="makePptx~createBodyProperties"><a href="makePptx.html#~createBodyProperties">createBodyProperties</a></li>
            
                <li data-name="makePptx~CreateFieldText"><a href="makePptx.html#~CreateFieldText">CreateFieldText</a></li>
            
                <li data-name="makePptx~getShapeInfo"><a href="makePptx.html#~getShapeInfo">getShapeInfo</a></li>
            
                <li data-name="makePptx~parseSmartNumber"><a href="makePptx.html#~parseSmartNumber">parseSmartNumber</a></li>
            
                <li data-name="makePptx~setDefaultDocValues"><a href="makePptx.html#~setDefaultDocValues">setDefaultDocValues</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makespknotesplugin">
            <span class="title">
                <a href="makespknotesplugin.html">makespknotesplugin</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makespknotesplugin#beforeGen"><a href="makespknotesplugin.html#beforeGen">beforeGen</a></li>
            
                <li data-name="makespknotesplugin#cbMakePptxNotesMasters"><a href="makespknotesplugin.html#cbMakePptxNotesMasters">cbMakePptxNotesMasters</a></li>
            
                <li data-name="makespknotesplugin#cbMakePptxSpkNote"><a href="makespknotesplugin.html#cbMakePptxSpkNote">cbMakePptxSpkNote</a></li>
            
                <li data-name="makespknotesplugin#cbMakeTheme2"><a href="makespknotesplugin.html#cbMakeTheme2">cbMakeTheme2</a></li>
            
                <li data-name="makespknotesplugin#extendPptxSlideApi"><a href="makespknotesplugin.html#extendPptxSlideApi">extendPptxSlideApi</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makewidescreenplugin">
            <span class="title">
                <a href="makewidescreenplugin.html">makewidescreenplugin</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makewidescreenplugin#extendPptxApi"><a href="makewidescreenplugin.html#extendPptxApi">extendPptxApi</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="makeXlsx">
            <span class="title">
                <a href="makeXlsx.html">makeXlsx</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="makeXlsx~cbCellToNumber"><a href="makeXlsx.html#~cbCellToNumber">cbCellToNumber</a></li>
            
                <li data-name="makeXlsx~cbMakeXlsApp"><a href="makeXlsx.html#~cbMakeXlsApp">cbMakeXlsApp</a></li>
            
                <li data-name="makeXlsx~cbMakeXlsSharedStrings"><a href="makeXlsx.html#~cbMakeXlsSharedStrings">cbMakeXlsSharedStrings</a></li>
            
                <li data-name="makeXlsx~cbMakeXlsSheet"><a href="makeXlsx.html#~cbMakeXlsSheet">cbMakeXlsSheet</a></li>
            
                <li data-name="makeXlsx~cbMakeXlsStyles"><a href="makeXlsx.html#~cbMakeXlsStyles">cbMakeXlsStyles</a></li>
            
                <li data-name="makeXlsx~cbMakeXlsWorkbook"><a href="makeXlsx.html#~cbMakeXlsWorkbook">cbMakeXlsWorkbook</a></li>
            
                <li data-name="makeXlsx~cbNumberToCell"><a href="makeXlsx.html#~cbNumberToCell">cbNumberToCell</a></li>
            
                <li data-name="makeXlsx~cbPrepareXlsxToGenerate"><a href="makeXlsx.html#~cbPrepareXlsxToGenerate">cbPrepareXlsxToGenerate</a></li>
            
                <li data-name="makeXlsx~setDefaultDocValues"><a href="makeXlsx.html#~setDefaultDocValues">setDefaultDocValues</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="officegen">
            <span class="title">
                <a href="officegen.html">officegen</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="officegen#addResourceToParse"><a href="officegen.html#addResourceToParse">addResourceToParse</a></li>
            
                <li data-name="officegen#generate"><a href="officegen.html#generate">generate</a></li>
            
                <li data-name="officegen#startNewDoc"><a href="officegen.html#startNewDoc">startNewDoc</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="lib_pptxplg-speakernotes.js.html">Source: lib/pptxplg-speakernotes.js</h1>
        


    
    <section>
        <article>
            <pre id="source-code" class="prettyprint source "><code>//
// officegen: speaker notes support for pptx documents.
//
// Please refer to README.md for this module's documentations.
//
// NOTE:
// - Before changing this code please refer to the hacking the code section on README.md.
//
// Copyright (c) 2017 Ziv Barber;
//
// Permission is hereby granted, free of charge, to any person obtaining
// a copy of this software and associated documentation files (the
// 'Software'), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to
// permit persons to whom the Software is furnished to do so, subject to
// the following conditions:
//
// The above copyright notice and this permission notice shall be
// included in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,
// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
//

/**
 * This function creating the pptx speaker notes plugin object.
 * @param {object} pluginsman Access to the plugins manager for pptx documents.
 * @constructor
 * @name makespknotesplugin
 */
function makespknotesplugin ( pluginsman ) {
	var funcThis = this;

	if ( pluginsman.docType !== 'pptx' &amp;&amp; pluginsman.docType !== 'ppsx' ) {
		throw "[pptx-speakernotes] This plugin supporting only PowerPoint based documents.";
	} // Endif.

	this.ogPluginsApi = pluginsman.ogPluginsApi; // Generic officegen API for plugins.
	this.msPluginsApi = pluginsman.genPrivate.plugs.type.msoffice; // msoffice plugins API.
	this.pluginsman = pluginsman; // Document type specific plugins API.

	this.pptxData = pluginsman.getDataStorage (); // Here you can store any temporary data needed for generating the document and depending on the data filled by the user.

	this.mainPath = pluginsman.genPrivate.features.type.msoffice.main_path; // The "folder" name inside the document zip that all the specific resources of this document type are stored.
	this.mainPathFile = pluginsman.genPrivate.features.type.msoffice.main_path_file; // The name of the main real xml resource of this document.
	this.relsMain = pluginsman.genPrivate.type.msoffice.rels_main; // Main rels file.
	this.relsApp = pluginsman.genPrivate.type.msoffice.rels_app; // Main rels file inside the specific document type "folder".
	this.filesList = pluginsman.genPrivate.type.msoffice.files_list; // Resources list xml.
	this.srcFilesList = pluginsman.genPrivate.type.msoffice.src_files_list; // For storing extra files inside the document zip.

	//
	// Catch events inside the document so we can extent it:
	//

	// We want to extend the slide object API:
	pluginsman.registerCallback ( 'newPage', function ( docData ) { funcThis.extendPptxSlideApi ( docData ); } );

	// This event tell us that the generator is about to start working:
	pluginsman.registerCallback ( 'beforeGen', function ( docObj ) { funcThis.beforeGen ( docObj ); } );

	return this;
}

//
// Events implementations:
//

/**
 * This function extending a new created slide object with new API methods.
 * @param {object} docData Object with information about the new slide and more.
 */
makespknotesplugin.prototype.extendPptxSlideApi = function ( docData ) {
	var funcThis = this;
	var newSlide = docData.page; // The new slide's API.
	var slideData = docData.pageData; // Place here data related to the slide.

	newSlide.setSpeakerNote = function ( messageText ) {
		slideData.speakerNoteMsg = messageText;
	};
}

/**
 * This function been called just before starting to generate the output document zip.
 * @param {object} docObj Document object.
 */
makespknotesplugin.prototype.beforeGen = function ( docObj ) {
	var funcThis = this;

	var notesCount = 0;
	this.pluginsman.genPrivate.pages.forEach ( function ( value, indexId ) {
		if ( value.speakerNoteMsg ) {
			// Add each speaker note:
			funcThis.ogPluginsApi.intAddAnyResourceToParse ( funcThis.mainPath + '\\notesSlides\\notesSlide' + (notesCount + 1) + '.xml', 'buffer', { slide: value, slideNum: indexId + 1 }, function ( data ) { return funcThis.cbMakePptxSpkNote ( data ) }, false );
			funcThis.ogPluginsApi.intAddAnyResourceToParse ( funcThis.mainPath + '\\notesSlides\\_rels\\notesSlide' + (notesCount + 1) + '.xml.rels', 'buffer', [
				{
					type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesMaster',
					target: '../notesMasters/notesMaster1.xml'
				},
				{
					type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide',
					target: '../slides/slide' + (indexId + 1) + '.xml'
				}
			], funcThis.pluginsman.genPrivate.plugs.type.msoffice.cbMakeRels, false );

			// We'll connect the slide to this note:
			value.rels.push ({
				type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesSlide',
				target: '../notesSlides/notesSlide' + (notesCount + 1) + '.xml'
			});

			// Add this speaker note to the list of files in the document:
			funcThis.filesList.push ({
				name: '/' + funcThis.mainPath + '/notesSlides/notesSlide' + (notesCount + 1) + '.xml',
				type: 'application/vnd.openxmlformats-officedocument.presentationml.notesSlide+xml',
				clear: 'generate' // Placing 'generate' here means that officegen will destroy this entry in the files list after finishing to generate the document.
			});

			notesCount++;
		} // Endif.
	});

	if ( notesCount ) {
		// Speaker notes - master:
		this.ogPluginsApi.intAddAnyResourceToParse ( this.mainPath + '\\notesMasters\\notesMaster1.xml', 'buffer', null, function ( data ) { return funcThis.cbMakePptxNotesMasters ( data ) }, false );
		this.ogPluginsApi.intAddAnyResourceToParse ( this.mainPath + '\\notesMasters\\_rels\\notesMaster1.xml.rels', 'buffer', [
			{
				type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',
				target: '../theme/theme1.xml'
			}
		], this.pluginsman.genPrivate.plugs.type.msoffice.cbMakeRels, false );

		// Add a rel entry to the main pptx rels:
		this.relsApp.push ({
			target: 'notesMasters/notesMaster1.xml',
			type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesMaster',
			clear: 'generate' // Placing 'generate' here means that officegen will destroy this entry in the files list after finishing to generate the document.
		});

		// Add the notes master to the list of files in the document:
		this.filesList.push ({
			name: '/' + this.mainPath + '/notesMasters/notesMaster1.xml',
			type: 'application/vnd.openxmlformats-officedocument.presentationml.notesMaster+xml',
			clear: 'generate' // Placing 'generate' here means that officegen will destroy this entry in the files list after finishing to generate the document.
		});
	} // Endif.
}

//
// Resource generating callbacks:
//

/**
 * Generate the 2nd theme, needed to support speaker notes.
 *
 * @param {object} data Ignored by this callback function.
 * @return Text string.
 */
makespknotesplugin.prototype.cbMakeTheme2 = function ( data ) {
	return this.msPluginsApi.cbMakeMsOfficeBasicXml ( data ) + '&lt;a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">&lt;a:themeElements>&lt;a:clrScheme name="Office">&lt;a:dk1>&lt;a:sysClr val="windowText" lastClr="000000"/>&lt;/a:dk1>&lt;a:lt1>&lt;a:sysClr val="window" lastClr="FFFFFF"/>&lt;/a:lt1>&lt;a:dk2>&lt;a:srgbClr val="1F497D"/>&lt;/a:dk2>&lt;a:lt2>&lt;a:srgbClr val="EEECE1"/>&lt;/a:lt2>&lt;a:accent1>&lt;a:srgbClr val="4F81BD"/>&lt;/a:accent1>&lt;a:accent2>&lt;a:srgbClr val="C0504D"/>&lt;/a:accent2>&lt;a:accent3>&lt;a:srgbClr val="9BBB59"/>&lt;/a:accent3>&lt;a:accent4>&lt;a:srgbClr val="8064A2"/>&lt;/a:accent4>&lt;a:accent5>&lt;a:srgbClr val="4BACC6"/>&lt;/a:accent5>&lt;a:accent6>&lt;a:srgbClr val="F79646"/>&lt;/a:accent6>&lt;a:hlink>&lt;a:srgbClr val="0000FF"/>&lt;/a:hlink>&lt;a:folHlink>&lt;a:srgbClr val="800080"/>&lt;/a:folHlink>&lt;/a:clrScheme>&lt;a:fontScheme name="Office">&lt;a:majorFont>&lt;a:latin typeface="Calibri"/>&lt;a:ea typeface=""/>&lt;a:cs typeface=""/>&lt;a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>&lt;a:font script="Hang" typeface="맑은 고딕"/>&lt;a:font script="Hans" typeface="宋体"/>&lt;a:font script="Hant" typeface="新細明體"/>&lt;a:font script="Arab" typeface="Times New Roman"/>&lt;a:font script="Hebr" typeface="Times New Roman"/>&lt;a:font script="Thai" typeface="Angsana New"/>&lt;a:font script="Ethi" typeface="Nyala"/>&lt;a:font script="Beng" typeface="Vrinda"/>&lt;a:font script="Gujr" typeface="Shruti"/>&lt;a:font script="Khmr" typeface="MoolBoran"/>&lt;a:font script="Knda" typeface="Tunga"/>&lt;a:font script="Guru" typeface="Raavi"/>&lt;a:font script="Cans" typeface="Euphemia"/>&lt;a:font script="Cher" typeface="Plantagenet Cherokee"/>&lt;a:font script="Yiii" typeface="Microsoft Yi Baiti"/>&lt;a:font script="Tibt" typeface="Microsoft Himalaya"/>&lt;a:font script="Thaa" typeface="MV Boli"/>&lt;a:font script="Deva" typeface="Mangal"/>&lt;a:font script="Telu" typeface="Gautami"/>&lt;a:font script="Taml" typeface="Latha"/>&lt;a:font script="Syrc" typeface="Estrangelo Edessa"/>&lt;a:font script="Orya" typeface="Kalinga"/>&lt;a:font script="Mlym" typeface="Kartika"/>&lt;a:font script="Laoo" typeface="DokChampa"/>&lt;a:font script="Sinh" typeface="Iskoola Pota"/>&lt;a:font script="Mong" typeface="Mongolian Baiti"/>&lt;a:font script="Viet" typeface="Times New Roman"/>&lt;a:font script="Uigh" typeface="Microsoft Uighur"/>&lt;/a:majorFont>&lt;a:minorFont>&lt;a:latin typeface="Calibri"/>&lt;a:ea typeface=""/>&lt;a:cs typeface=""/>&lt;a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>&lt;a:font script="Hang" typeface="맑은 고딕"/>&lt;a:font script="Hans" typeface="宋体"/>&lt;a:font script="Hant" typeface="新細明體"/>&lt;a:font script="Arab" typeface="Arial"/>&lt;a:font script="Hebr" typeface="Arial"/>&lt;a:font script="Thai" typeface="Cordia New"/>&lt;a:font script="Ethi" typeface="Nyala"/>&lt;a:font script="Beng" typeface="Vrinda"/>&lt;a:font script="Gujr" typeface="Shruti"/>&lt;a:font script="Khmr" typeface="DaunPenh"/>&lt;a:font script="Knda" typeface="Tunga"/>&lt;a:font script="Guru" typeface="Raavi"/>&lt;a:font script="Cans" typeface="Euphemia"/>&lt;a:font script="Cher" typeface="Plantagenet Cherokee"/>&lt;a:font script="Yiii" typeface="Microsoft Yi Baiti"/>&lt;a:font script="Tibt" typeface="Microsoft Himalaya"/>&lt;a:font script="Thaa" typeface="MV Boli"/>&lt;a:font script="Deva" typeface="Mangal"/>&lt;a:font script="Telu" typeface="Gautami"/>&lt;a:font script="Taml" typeface="Latha"/>&lt;a:font script="Syrc" typeface="Estrangelo Edessa"/>&lt;a:font script="Orya" typeface="Kalinga"/>&lt;a:font script="Mlym" typeface="Kartika"/>&lt;a:font script="Laoo" typeface="DokChampa"/>&lt;a:font script="Sinh" typeface="Iskoola Pota"/>&lt;a:font script="Mong" typeface="Mongolian Baiti"/>&lt;a:font script="Viet" typeface="Arial"/>&lt;a:font script="Uigh" typeface="Microsoft Uighur"/>&lt;/a:minorFont>&lt;/a:fontScheme>&lt;a:fmtScheme name="Office">&lt;a:fillStyleLst>&lt;a:solidFill>&lt;a:schemeClr val="phClr"/>&lt;/a:solidFill>&lt;a:gradFill rotWithShape="1">&lt;a:gsLst>&lt;a:gs pos="0">&lt;a:schemeClr val="phClr">&lt;a:tint val="50000"/>&lt;a:satMod val="300000"/>&lt;/a:schemeClr>&lt;/a:gs>&lt;a:gs pos="35000">&lt;a:schemeClr val="phClr">&lt;a:tint val="37000"/>&lt;a:satMod val="300000"/>&lt;/a:schemeClr>&lt;/a:gs>&lt;a:gs pos="100000">&lt;a:schemeClr val="phClr">&lt;a:tint val="15000"/>&lt;a:satMod val="350000"/>&lt;/a:schemeClr>&lt;/a:gs>&lt;/a:gsLst>&lt;a:lin ang="16200000" scaled="1"/>&lt;/a:gradFill>&lt;a:gradFill rotWithShape="1">&lt;a:gsLst>&lt;a:gs pos="0">&lt;a:schemeClr val="phClr">&lt;a:shade val="51000"/>&lt;a:satMod val="130000"/>&lt;/a:schemeClr>&lt;/a:gs>&lt;a:gs pos="80000">&lt;a:schemeClr val="phClr">&lt;a:shade val="93000"/>&lt;a:satMod val="130000"/>&lt;/a:schemeClr>&lt;/a:gs>&lt;a:gs pos="100000">&lt;a:schemeClr val="phClr">&lt;a:shade val="94000"/>&lt;a:satMod val="135000"/>&lt;/a:schemeClr>&lt;/a:gs>&lt;/a:gsLst>&lt;a:lin ang="16200000" scaled="0"/>&lt;/a:gradFill>&lt;/a:fillStyleLst>&lt;a:lnStyleLst>&lt;a:ln w="9525" cap="flat" cmpd="sng" algn="ctr">&lt;a:solidFill>&lt;a:schemeClr val="phClr">&lt;a:shade val="95000"/>&lt;a:satMod val="105000"/>&lt;/a:schemeClr>&lt;/a:solidFill>&lt;a:prstDash val="solid"/>&lt;/a:ln>&lt;a:ln w="25400" cap="flat" cmpd="sng" algn="ctr">&lt;a:solidFill>&lt;a:schemeClr val="phClr"/>&lt;/a:solidFill>&lt;a:prstDash val="solid"/>&lt;/a:ln>&lt;a:ln w="38100" cap="flat" cmpd="sng" algn="ctr">&lt;a:solidFill>&lt;a:schemeClr val="phClr"/>&lt;/a:solidFill>&lt;a:prstDash val="solid"/>&lt;/a:ln>&lt;/a:lnStyleLst>&lt;a:effectStyleLst>&lt;a:effectStyle>&lt;a:effectLst>&lt;a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0">&lt;a:srgbClr val="000000">&lt;a:alpha val="38000"/>&lt;/a:srgbClr>&lt;/a:outerShdw>&lt;/a:effectLst>&lt;/a:effectStyle>&lt;a:effectStyle>&lt;a:effectLst>&lt;a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0">&lt;a:srgbClr val="000000">&lt;a:alpha val="35000"/>&lt;/a:srgbClr>&lt;/a:outerShdw>&lt;/a:effectLst>&lt;/a:effectStyle>&lt;a:effectStyle>&lt;a:effectLst>&lt;a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0">&lt;a:srgbClr val="000000">&lt;a:alpha val="35000"/>&lt;/a:srgbClr>&lt;/a:outerShdw>&lt;/a:effectLst>&lt;a:scene3d>&lt;a:camera prst="orthographicFront">&lt;a:rot lat="0" lon="0" rev="0"/>&lt;/a:camera>&lt;a:lightRig rig="threePt" dir="t">&lt;a:rot lat="0" lon="0" rev="1200000"/>&lt;/a:lightRig>&lt;/a:scene3d>&lt;a:sp3d>&lt;a:bevelT w="63500" h="25400"/>&lt;/a:sp3d>&lt;/a:effectStyle>&lt;/a:effectStyleLst>&lt;a:bgFillStyleLst>&lt;a:solidFill>&lt;a:schemeClr val="phClr"/>&lt;/a:solidFill>&lt;a:gradFill rotWithShape="1">&lt;a:gsLst>&lt;a:gs pos="0">&lt;a:schemeClr val="phClr">&lt;a:tint val="40000"/>&lt;a:satMod val="350000"/>&lt;/a:schemeClr>&lt;/a:gs>&lt;a:gs pos="40000">&lt;a:schemeClr val="phClr">&lt;a:tint val="45000"/>&lt;a:shade val="99000"/>&lt;a:satMod val="350000"/>&lt;/a:schemeClr>&lt;/a:gs>&lt;a:gs pos="100000">&lt;a:schemeClr val="phClr">&lt;a:shade val="20000"/>&lt;a:satMod val="255000"/>&lt;/a:schemeClr>&lt;/a:gs>&lt;/a:gsLst>&lt;a:path path="circle">&lt;a:fillToRect l="50000" t="-80000" r="50000" b="180000"/>&lt;/a:path>&lt;/a:gradFill>&lt;a:gradFill rotWithShape="1">&lt;a:gsLst>&lt;a:gs pos="0">&lt;a:schemeClr val="phClr">&lt;a:tint val="80000"/>&lt;a:satMod val="300000"/>&lt;/a:schemeClr>&lt;/a:gs>&lt;a:gs pos="100000">&lt;a:schemeClr val="phClr">&lt;a:shade val="30000"/>&lt;a:satMod val="200000"/>&lt;/a:schemeClr>&lt;/a:gs>&lt;/a:gsLst>&lt;a:path path="circle">&lt;a:fillToRect l="50000" t="50000" r="50000" b="50000"/>&lt;/a:path>&lt;/a:gradFill>&lt;/a:bgFillStyleLst>&lt;/a:fmtScheme>&lt;/a:themeElements>&lt;a:objectDefaults/>&lt;a:extraClrSchemeLst/>&lt;/a:theme>';
}

/**
 * Generate the speaker notes master.
 *
 * @param {object} data Data needed to generate this resource.
 * @return Text string.
 */
makespknotesplugin.prototype.cbMakePptxNotesMasters = function ( data ) {
	return this.msPluginsApi.cbMakeMsOfficeBasicXml ( data ) + '&lt;p:notesMaster xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:p="http://schemas.openxmlformats.org/presentationml/2006/main">&lt;p:cSld>&lt;p:bg>&lt;p:bgRef idx="1001">&lt;a:schemeClr val="bg1"/>&lt;/p:bgRef>&lt;/p:bg>&lt;p:spTree>&lt;p:nvGrpSpPr>&lt;p:cNvPr id="1" name=""/>&lt;p:cNvGrpSpPr/>&lt;p:nvPr/>&lt;/p:nvGrpSpPr>&lt;p:grpSpPr>&lt;a:xfrm>&lt;a:off x="0" y="0"/>&lt;a:ext cx="0" cy="0"/>&lt;a:chOff x="0" y="0"/>&lt;a:chExt cx="0" cy="0"/>&lt;/a:xfrm>&lt;/p:grpSpPr>&lt;p:sp>&lt;p:nvSpPr>&lt;p:cNvPr id="2" name="Header Placeholder 1"/>&lt;p:cNvSpPr>&lt;a:spLocks noGrp="1"/>&lt;/p:cNvSpPr>&lt;p:nvPr>&lt;p:ph type="hdr" sz="quarter"/>&lt;/p:nvPr>&lt;/p:nvSpPr>&lt;p:spPr>&lt;a:xfrm>&lt;a:off x="0" y="0"/>&lt;a:ext cx="2971800" cy="457200"/>&lt;/a:xfrm>&lt;a:prstGeom prst="rect">&lt;a:avLst/>&lt;/a:prstGeom>&lt;/p:spPr>&lt;p:txBody>&lt;a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0"/>&lt;a:lstStyle>&lt;a:lvl1pPr algn="l">&lt;a:defRPr sz="1200"/>&lt;/a:lvl1pPr>&lt;/a:lstStyle>&lt;a:p>&lt;a:endParaRPr lang="en-US"/>&lt;/a:p>&lt;/p:txBody>&lt;/p:sp>&lt;p:sp>&lt;p:nvSpPr>&lt;p:cNvPr id="3" name="Date Placeholder 2"/>&lt;p:cNvSpPr>&lt;a:spLocks noGrp="1"/>&lt;/p:cNvSpPr>&lt;p:nvPr>&lt;p:ph type="dt" idx="1"/>&lt;/p:nvPr>&lt;/p:nvSpPr>&lt;p:spPr>&lt;a:xfrm>&lt;a:off x="3884613" y="0"/>&lt;a:ext cx="2971800" cy="457200"/>&lt;/a:xfrm>&lt;a:prstGeom prst="rect">&lt;a:avLst/>&lt;/a:prstGeom>&lt;/p:spPr>&lt;p:txBody>&lt;a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0"/>&lt;a:lstStyle>&lt;a:lvl1pPr algn="r">&lt;a:defRPr sz="1200"/>&lt;/a:lvl1pPr>&lt;/a:lstStyle>&lt;a:p>&lt;a:fld id="{AA6EBAA8-ADDE-4290-A9BE-D64DC1002B1F}" type="datetimeFigureOut">&lt;a:rPr lang="en-US" smtClean="0"/>&lt;a:t>2/3/2017&lt;/a:t>&lt;/a:fld>&lt;a:endParaRPr lang="en-US"/>&lt;/a:p>&lt;/p:txBody>&lt;/p:sp>&lt;p:sp>&lt;p:nvSpPr>&lt;p:cNvPr id="4" name="Slide Image Placeholder 3"/>&lt;p:cNvSpPr>&lt;a:spLocks noGrp="1" noRot="1" noChangeAspect="1"/>&lt;/p:cNvSpPr>&lt;p:nvPr>&lt;p:ph type="sldImg" idx="2"/>&lt;/p:nvPr>&lt;/p:nvSpPr>&lt;p:spPr>&lt;a:xfrm>&lt;a:off x="1143000" y="685800"/>&lt;a:ext cx="4572000" cy="3429000"/>&lt;/a:xfrm>&lt;a:prstGeom prst="rect">&lt;a:avLst/>&lt;/a:prstGeom>&lt;a:noFill/>&lt;a:ln w="12700">&lt;a:solidFill>&lt;a:prstClr val="black"/>&lt;/a:solidFill>&lt;/a:ln>&lt;/p:spPr>&lt;p:txBody>&lt;a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr"/>&lt;a:lstStyle/>&lt;a:p>&lt;a:endParaRPr lang="en-US"/>&lt;/a:p>&lt;/p:txBody>&lt;/p:sp>&lt;p:sp>&lt;p:nvSpPr>&lt;p:cNvPr id="5" name="Notes Placeholder 4"/>&lt;p:cNvSpPr>&lt;a:spLocks noGrp="1"/>&lt;/p:cNvSpPr>&lt;p:nvPr>&lt;p:ph type="body" sz="quarter" idx="3"/>&lt;/p:nvPr>&lt;/p:nvSpPr>&lt;p:spPr>&lt;a:xfrm>&lt;a:off x="685800" y="4343400"/>&lt;a:ext cx="5486400" cy="4114800"/>&lt;/a:xfrm>&lt;a:prstGeom prst="rect">&lt;a:avLst/>&lt;/a:prstGeom>&lt;/p:spPr>&lt;p:txBody>&lt;a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0">&lt;a:normAutofit/>&lt;/a:bodyPr>&lt;a:lstStyle/>&lt;a:p>&lt;a:pPr lvl="0"/>&lt;a:r>&lt;a:rPr lang="en-US" smtClean="0"/>&lt;a:t>Click to edit Master text styles&lt;/a:t>&lt;/a:r>&lt;/a:p>&lt;a:p>&lt;a:pPr lvl="1"/>&lt;a:r>&lt;a:rPr lang="en-US" smtClean="0"/>&lt;a:t>Second level&lt;/a:t>&lt;/a:r>&lt;/a:p>&lt;a:p>&lt;a:pPr lvl="2"/>&lt;a:r>&lt;a:rPr lang="en-US" smtClean="0"/>&lt;a:t>Third level&lt;/a:t>&lt;/a:r>&lt;/a:p>&lt;a:p>&lt;a:pPr lvl="3"/>&lt;a:r>&lt;a:rPr lang="en-US" smtClean="0"/>&lt;a:t>Fourth level&lt;/a:t>&lt;/a:r>&lt;/a:p>&lt;a:p>&lt;a:pPr lvl="4"/>&lt;a:r>&lt;a:rPr lang="en-US" smtClean="0"/>&lt;a:t>Fifth level&lt;/a:t>&lt;/a:r>&lt;a:endParaRPr lang="en-US"/>&lt;/a:p>&lt;/p:txBody>&lt;/p:sp>&lt;p:sp>&lt;p:nvSpPr>&lt;p:cNvPr id="6" name="Footer Placeholder 5"/>&lt;p:cNvSpPr>&lt;a:spLocks noGrp="1"/>&lt;/p:cNvSpPr>&lt;p:nvPr>&lt;p:ph type="ftr" sz="quarter" idx="4"/>&lt;/p:nvPr>&lt;/p:nvSpPr>&lt;p:spPr>&lt;a:xfrm>&lt;a:off x="0" y="8685213"/>&lt;a:ext cx="2971800" cy="457200"/>&lt;/a:xfrm>&lt;a:prstGeom prst="rect">&lt;a:avLst/>&lt;/a:prstGeom>&lt;/p:spPr>&lt;p:txBody>&lt;a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="b"/>&lt;a:lstStyle>&lt;a:lvl1pPr algn="l">&lt;a:defRPr sz="1200"/>&lt;/a:lvl1pPr>&lt;/a:lstStyle>&lt;a:p>&lt;a:endParaRPr lang="en-US"/>&lt;/a:p>&lt;/p:txBody>&lt;/p:sp>&lt;p:sp>&lt;p:nvSpPr>&lt;p:cNvPr id="7" name="Slide Number Placeholder 6"/>&lt;p:cNvSpPr>&lt;a:spLocks noGrp="1"/>&lt;/p:cNvSpPr>&lt;p:nvPr>&lt;p:ph type="sldNum" sz="quarter" idx="5"/>&lt;/p:nvPr>&lt;/p:nvSpPr>&lt;p:spPr>&lt;a:xfrm>&lt;a:off x="3884613" y="8685213"/>&lt;a:ext cx="2971800" cy="457200"/>&lt;/a:xfrm>&lt;a:prstGeom prst="rect">&lt;a:avLst/>&lt;/a:prstGeom>&lt;/p:spPr>&lt;p:txBody>&lt;a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="b"/>&lt;a:lstStyle>&lt;a:lvl1pPr algn="r">&lt;a:defRPr sz="1200"/>&lt;/a:lvl1pPr>&lt;/a:lstStyle>&lt;a:p>&lt;a:fld id="{E165F6F6-A11E-4DE0-B2DB-03E2E9A5946D}" type="slidenum">&lt;a:rPr lang="en-US" smtClean="0"/>&lt;a:t>‹#›&lt;/a:t>&lt;/a:fld>&lt;a:endParaRPr lang="en-US"/>&lt;/a:p>&lt;/p:txBody>&lt;/p:sp>&lt;/p:spTree>&lt;/p:cSld>&lt;p:clrMap bg1="lt1" tx1="dk1" bg2="lt2" tx2="dk2" accent1="accent1" accent2="accent2" accent3="accent3" accent4="accent4" accent5="accent5" accent6="accent6" hlink="hlink" folHlink="folHlink"/>&lt;p:notesStyle>&lt;a:lvl1pPr marL="0" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">&lt;a:defRPr sz="1200" kern="1200">&lt;a:solidFill>&lt;a:schemeClr val="tx1"/>&lt;/a:solidFill>&lt;a:latin typeface="+mn-lt"/>&lt;a:ea typeface="+mn-ea"/>&lt;a:cs typeface="+mn-cs"/>&lt;/a:defRPr>&lt;/a:lvl1pPr>&lt;a:lvl2pPr marL="457200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">&lt;a:defRPr sz="1200" kern="1200">&lt;a:solidFill>&lt;a:schemeClr val="tx1"/>&lt;/a:solidFill>&lt;a:latin typeface="+mn-lt"/>&lt;a:ea typeface="+mn-ea"/>&lt;a:cs typeface="+mn-cs"/>&lt;/a:defRPr>&lt;/a:lvl2pPr>&lt;a:lvl3pPr marL="914400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">&lt;a:defRPr sz="1200" kern="1200">&lt;a:solidFill>&lt;a:schemeClr val="tx1"/>&lt;/a:solidFill>&lt;a:latin typeface="+mn-lt"/>&lt;a:ea typeface="+mn-ea"/>&lt;a:cs typeface="+mn-cs"/>&lt;/a:defRPr>&lt;/a:lvl3pPr>&lt;a:lvl4pPr marL="1371600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">&lt;a:defRPr sz="1200" kern="1200">&lt;a:solidFill>&lt;a:schemeClr val="tx1"/>&lt;/a:solidFill>&lt;a:latin typeface="+mn-lt"/>&lt;a:ea typeface="+mn-ea"/>&lt;a:cs typeface="+mn-cs"/>&lt;/a:defRPr>&lt;/a:lvl4pPr>&lt;a:lvl5pPr marL="1828800" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">&lt;a:defRPr sz="1200" kern="1200">&lt;a:solidFill>&lt;a:schemeClr val="tx1"/>&lt;/a:solidFill>&lt;a:latin typeface="+mn-lt"/>&lt;a:ea typeface="+mn-ea"/>&lt;a:cs typeface="+mn-cs"/>&lt;/a:defRPr>&lt;/a:lvl5pPr>&lt;a:lvl6pPr marL="2286000" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">&lt;a:defRPr sz="1200" kern="1200">&lt;a:solidFill>&lt;a:schemeClr val="tx1"/>&lt;/a:solidFill>&lt;a:latin typeface="+mn-lt"/>&lt;a:ea typeface="+mn-ea"/>&lt;a:cs typeface="+mn-cs"/>&lt;/a:defRPr>&lt;/a:lvl6pPr>&lt;a:lvl7pPr marL="2743200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">&lt;a:defRPr sz="1200" kern="1200">&lt;a:solidFill>&lt;a:schemeClr val="tx1"/>&lt;/a:solidFill>&lt;a:latin typeface="+mn-lt"/>&lt;a:ea typeface="+mn-ea"/>&lt;a:cs typeface="+mn-cs"/>&lt;/a:defRPr>&lt;/a:lvl7pPr>&lt;a:lvl8pPr marL="3200400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">&lt;a:defRPr sz="1200" kern="1200">&lt;a:solidFill>&lt;a:schemeClr val="tx1"/>&lt;/a:solidFill>&lt;a:latin typeface="+mn-lt"/>&lt;a:ea typeface="+mn-ea"/>&lt;a:cs typeface="+mn-cs"/>&lt;/a:defRPr>&lt;/a:lvl8pPr>&lt;a:lvl9pPr marL="3657600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">&lt;a:defRPr sz="1200" kern="1200">&lt;a:solidFill>&lt;a:schemeClr val="tx1"/>&lt;/a:solidFill>&lt;a:latin typeface="+mn-lt"/>&lt;a:ea typeface="+mn-ea"/>&lt;a:cs typeface="+mn-cs"/>&lt;/a:defRPr>&lt;/a:lvl9pPr>&lt;/p:notesStyle>&lt;/p:notesMaster>';
}

/**
 * Generate a speaker note for a slide.
 *
 * @param {object} data Data needed to generate this resource.
 * @return Text string.
 */
makespknotesplugin.prototype.cbMakePptxSpkNote = function ( data ) {
	var dataOut = this.msPluginsApi.cbMakeMsOfficeBasicXml ( data ) + '&lt;p:notes xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:p="http://schemas.openxmlformats.org/presentationml/2006/main">&lt;p:cSld>&lt;p:spTree>&lt;p:nvGrpSpPr>&lt;p:cNvPr id="1" name=""/>&lt;p:cNvGrpSpPr/>&lt;p:nvPr/>&lt;/p:nvGrpSpPr>&lt;p:grpSpPr>&lt;a:xfrm>&lt;a:off x="0" y="0"/>&lt;a:ext cx="0" cy="0"/>&lt;a:chOff x="0" y="0"/>&lt;a:chExt cx="0" cy="0"/>&lt;/a:xfrm>&lt;/p:grpSpPr>&lt;p:sp>&lt;p:nvSpPr>&lt;p:cNvPr id="2" name="Slide Image Placeholder 1"/>&lt;p:cNvSpPr>&lt;a:spLocks noGrp="1" noRot="1" noChangeAspect="1"/>&lt;/p:cNvSpPr>&lt;p:nvPr>&lt;p:ph type="sldImg"/>&lt;/p:nvPr>&lt;/p:nvSpPr>&lt;p:spPr/>&lt;/p:sp>&lt;p:sp>&lt;p:nvSpPr>&lt;p:cNvPr id="3" name="Notes Placeholder 2"/>&lt;p:cNvSpPr>&lt;a:spLocks noGrp="1"/>&lt;/p:cNvSpPr>&lt;p:nvPr>&lt;p:ph type="body" idx="1"/>&lt;/p:nvPr>&lt;/p:nvSpPr>&lt;p:spPr/>&lt;p:txBody>&lt;a:bodyPr>&lt;a:normAutofit/>&lt;/a:bodyPr>&lt;a:lstStyle/>&lt;a:p>&lt;a:r>&lt;a:rPr lang="en-US" dirty="0" err="1" smtClean="0"/>&lt;a:t>' + data.slide.speakerNoteMsg.encodeHTML () + '&lt;/a:t>&lt;/a:r>&lt;a:endParaRPr lang="en-US" dirty="0"/>&lt;/a:p>&lt;/p:txBody>&lt;/p:sp>&lt;p:sp>&lt;p:nvSpPr>&lt;p:cNvPr id="4" name="Slide Number Placeholder 3"/>&lt;p:cNvSpPr>&lt;a:spLocks noGrp="1"/>&lt;/p:cNvSpPr>&lt;p:nvPr>&lt;p:ph type="sldNum" sz="quarter" idx="10"/>&lt;/p:nvPr>&lt;/p:nvSpPr>&lt;p:spPr/>&lt;p:txBody>&lt;a:bodyPr/>&lt;a:lstStyle/>&lt;a:p>&lt;a:fld id="{E165F6F6-A11E-4DE0-B2DB-03E2E9A5946D}" type="slidenum">&lt;a:rPr lang="en-US" smtClean="0"/>&lt;a:t>' + data.slideNum + '&lt;/a:t>&lt;/a:fld>&lt;a:endParaRPr lang="en-US"/>&lt;/a:p>&lt;/p:txBody>&lt;/p:sp>&lt;/p:spTree>&lt;/p:cSld>&lt;p:clrMapOvr>&lt;a:masterClrMapping/>&lt;/p:clrMapOvr>&lt;/p:notes>';
	return dataOut;
}

module.exports = makespknotesplugin;
</code></pre>
        </article>
    </section>






        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.1</a> on Sun Feb 05 2017 05:03:39 GMT+0100 (W. Europe Standard Time)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/jaguar.js"></script>
</body>
</html>
